Imports System.Windows.Forms.VisualStyles.VisualStyleElement
Imports MySql.Data.MySqlClient
Imports System.Globalization
Imports System.Windows.Forms
Imports Mysqlx
Imports Google.Protobuf.WellKnownTypes
Imports System.Random
Imports System.ComponentModel

Public Class Battle

    Dim connectionString As String = "server=127.0.0.1;userid=root;password='';database=Pokemon_Game"   'STRING PARA DEFINIR A MINHA CONEXÃO COM O MYSQL'.
    Dim conn As New MySqlConnection(connectionString)                                                   'UMA INSTÂNCIA DA CLASSE MYSQLCONNECTION QUE DEFINE A CONEXÃO COM O BANCO DE DADOS.
    Dim DELETETEAM1 As New MySqlDataAdapter("DELETE FROM TIME1", conn)                                  'OBJETO USADO PARA DELETAR O CONTEÚDO DO TIME1 DA TABELA DO DATABASE.'
    Dim DELETETEAM2 As New MySqlDataAdapter("DELETE FROM TIME2", conn)                                  'OBJETO USADO PARA DELETAR O CONTEÚDO DO TIME2 DA TABELA DO DATABASE.'
    Dim DELETETEAM3 As New MySqlDataAdapter("DELETE FROM TIME3", conn)                                  'OBJETO USADO PARA DELETAR O CONTEÚDO DO TIME3 DA TABELA DO DATABASE.'
    Dim DELETETEAM4 As New MySqlDataAdapter("DELETE FROM TIME4", conn)                                  'OBJETO USADO PARA DELETAR O CONTEÚDO DO TIME3 DA TABELA DO DATABASE.'
    Dim LISTVIEW1 As New MySqlDataAdapter("SELECT HP, MP, PSTATUS FROM TIME1 WHERE NOME = @Nome", conn) 'OBJETO USADO PARA SELECIONAR DADOS E INSERI-LOS EM UMA LISTVIEW.'
    Dim LISTVIEW2 As New MySqlDataAdapter("SELECT HP, MP, PSTATUS FROM TIME2 WHERE NOME = @Nome", conn) 'OBJETO USADO PARA SELECIONAR DADOS E INSERI-LOS EM UMA LISTVIEW.'
    Dim MOVESTOBUTTONS As New MySqlDataAdapter("SELECT M.NOME AS MOVE
                                                    FROM Pokemon AS P
                                                    JOIN Moves AS M ON P.ID = M.Pokemon_ID
                                                    WHERE P.NOME = @Nome", conn)                        'OBJETO USADO PARA SELECIODAR DADOS DA TABELA POKEMON E MOVES E INSERI-LOS AOS BOTÕES DE ATAQUE.'
    Dim indexAlvo As Integer = -1
    Private selectedPokemon1 As String 'VARIÁVEL PARA ARMAZENAR O POKEMON SELECIONADO NA COMBOBOX1.'
    Private selectedPokemon2 As String 'VARIÁVEL PARA ARMAZENAR O POKEMON SELECIONADO NA COMBOBOX2.'
    Dim BattleCount As Integer = 0 'VARIÁVEL PARA CONTAR O TEMPO DA BATALHA.'
    Dim timer As New Timer()       'VARIÁVEL PARA CONTAR O TIMER.'
    Dim Turnbattle As Integer = 0  'VARIÁVEL PARA CONTAR OS TURNOS.'
    Dim Turn As Integer = 0        'VARIÁVEL REFERENTE AO TURNO ATUAL.'
    Public numeroAleatorio As Integer 'VARIÁVEL PARA GUARDAR UM NÚMERO ALEATÓRIO.'
    Private configuracaoBotao As Integer 'VARIÁVEL PARA GUARDAR O STATUS DE UM BOTÃO.'
    Dim random As New Random() 'VARIÁVEL RANDOM'
    Dim hidebuttons As Double = random.NextDouble() 'VARIÁVEL PARA GUARDAR UMA PROBABILIDADE RANDOM.'
    Public listView1Vazia As Boolean 'VARIÁVEL BOLEANA PARA GUARDAR O ESTADO DE UM BOTÃO.'
    Public listView2Vazia As Boolean 'VARIÁVEL BOLEANA PARA GUARDAR O ESTADO DE UM BOTÃO.'
    Public Pokepictures As New Dictionary(Of String, String) 'DICIONÁRIO DE IMAGENS RELACIONADO À STRINGS.'
    Public Time1 As New DataTable() 'TABELA INTERNA PARA GUARDAR O TIME1.'
    Public TIME1ESCOLHA As New MySqlDataAdapter("SELECT NOME FROM TIME1", conn) 'STRING DE CONEXÃO PARA O TIME1.'
    Public Time2 As New DataTable() 'TABELA INTERNA PARA GUARDAR O TIME2.'
    Public TIME2ESCOLHA As New MySqlDataAdapter("SELECT NOME FROM TIME2", conn) 'STRING DE CONEXÃO PARA O TIME2.'

    Sub LoadComboBoxData() 'FUNÇÃO PARA ENCHER A MINHA COMBOBOX COM POKEMON.'
        Dim TODOSPOKNAMES As New MySqlDataAdapter("SELECT NOME FROM TIME1", conn)  'UM OBJETO PARA SELECIONAR OS NOMES DOS POKEMON NO BANCO DE DADOS.'
        Dim TODOSPOKNAMES2 As New MySqlDataAdapter("SELECT NOME FROM TIME2", conn) 'UM OBJETO PARA SELECIONAR OS NOMES DOS POKEMON NO BANCO DE DADOS.'
        Dim POKEMONAMES As New DataTable()                                         'UMA TABELA PARA GUARDAR TODOS OS NOMES DOS POKEMON.'
        Dim POKEMONAMES2 As New DataTable()                                        'UMA TABELA PARA GUARDAR TODOS OS NOMES DOS POKEMON.'
        TODOSPOKNAMES.Fill(POKEMONAMES)   'OBJETO ENCHENDO A TABELA INTERNA POKEMONAMES.'
        TODOSPOKNAMES2.Fill(POKEMONAMES2) 'OBJETO ENCHENDO A TABELA INTERNA POKEMONAMES.'
        ComboBox1_TIMEPLAYER1.DataSource = POKEMONAMES  'PREENCHE A COMBOBOX COM A TABELA INTERNA'.
        ComboBox1_TIMEPLAYER1.DisplayMember = "NOME"    'DEFINE NOME COMO A COLUNA A SER EXIBIDA NA COMBOBOX.'
        ComboBox2_TIMEPLAYER2.DataSource = POKEMONAMES2 'PREENCHE A COMBOBOX COM A TABELA INTERNA'.
        ComboBox2_TIMEPLAYER2.DisplayMember = "NOME"    'DEFINE NOME COMO A COLUNA A SER EXIBIDA NA COMBOBOX.'
    End Sub

    Sub Pokeimagens() 'UMA SUB PARA GUARDAR OS ITENS ADICIONADOS NO DICIONÁRIOS DE IMAGENS.'

        Pokepictures.Clear() 'O DICIONÁRIO SEMPRE DEVE SER LIMPO ANTES DE SER CHAMADO PARA EVITAR ERROS DE DUPLICAÇÃO DE CHAVES.'

        'O DICIONÁRIO CONTÉM UMA STRING DE REFERÊNCIA E É SEGUIDO PELO DIRETÓRIO AO QUAL ESTÁ ALOCADO.'

        Pokepictures.Add("Bulbasaur", "C:\proj\Pokemons_Imagens3\1.png")
        Pokepictures.Add("Charmander", "C:\proj\Pokemons_Imagens3\2.png")
        Pokepictures.Add("Squirtle", "C:\proj\Pokemons_Imagens3\3.png")
        Pokepictures.Add("Pikachu", "C:\proj\Pokemons_Imagens3\4.png")
        Pokepictures.Add("Jigglypuff", "C:\proj\Pokemons_Imagens3\5.png")
        Pokepictures.Add("Zubat", "C:\proj\Pokemons_Imagens3\6.png")
        Pokepictures.Add("Geodude", "C:\proj\Pokemons_Imagens3\7.png")
        Pokepictures.Add("Machop", "C:\proj\Pokemons_Imagens3\8.png")
        Pokepictures.Add("Ditto", "C:\proj\Pokemons_Imagens3\9.png")
        Pokepictures.Add("Eevee", "C:\proj\Pokemons_Imagens3\10.png")
        Pokepictures.Add("Porygon", "C:\proj\Pokemons_Imagens3\11.png")
        Pokepictures.Add("Clefairy", "C:\proj\Pokemons_Imagens3\12.png")
        Pokepictures.Add("Vulpix", "C:\proj\Pokemons_Imagens3\13.png")
        Pokepictures.Add("Oddish", "C:\proj\Pokemons_Imagens3\14.png")
        Pokepictures.Add("Paras", "C:\proj\Pokemons_Imagens3\15.png")
        Pokepictures.Add("Venonat", "C:\proj\Pokemons_Imagens3\16.png")
        Pokepictures.Add("Meowth", "C:\proj\Pokemons_Imagens3\17.png")
        Pokepictures.Add("Psyduck", "C:\proj\Pokemons_Imagens3\18.png")
        Pokepictures.Add("Mankey", "C:\proj\Pokemons_Imagens3\19.png")
        Pokepictures.Add("Growlithe", "C:\proj\Pokemons_Imagens3\20.png")
        Pokepictures.Add("Poliwag", "C:\proj\Pokemons_Imagens3\21.png")
        Pokepictures.Add("Abra", "C:\proj\Pokemons_Imagens3\22.png")
        Pokepictures.Add("Magikarp", "C:\proj\Pokemons_Imagens3\23.png")
        Pokepictures.Add("Bellsprout", "C:\proj\Pokemons_Imagens3\24.png")
        Pokepictures.Add("Tentacool", "C:\proj\Pokemons_Imagens3\25.png")
        Pokepictures.Add("Pidgey", "C:\proj\Pokemons_Imagens3\26.png")
        Pokepictures.Add("Spearow", "C:\proj\Pokemons_Imagens3\27.png")
        Pokepictures.Add("Farfetch'd", "C:\proj\Pokemons_Imagens3\28.png")
        Pokepictures.Add("Doduo", "C:\proj\Pokemons_Imagens3\29.png")
        Pokepictures.Add("Gastly", "C:\proj\Pokemons_Imagens3\30.png")

    End Sub

    Public Sub AssociarImagemAoNome(nomeControle As String) 'UMA FUNÇÃO CRIADA PARA CHAMAR O DICIONÁRIO'

        'A FUNÇÃO USA A STRING DE REFERÊNCIA PARA PERCORRER O DIRETÓRIO EM BUSCA DA IMAGEM.'

        Pokeimagens() 'CHAMADA DO DICIONÁRIO.'

        If Pokepictures.ContainsKey(nomeControle) Then 'SE O DICIONÁRIO RECEBE A STRING DE REFERÊNCIA...
            PictureBox1_PLAYER1.Image = Image.FromFile(Pokepictures(nomeControle)) 'ELE RETORNA A IMAGEM REFERENTE A STRIN.'
        Else 'DO CONTRÁRIO...
            PictureBox1_PLAYER1.Image = Nothing 'NADA É RETORNADO.'
        End If

    End Sub

    Private Sub AssociarImagemAoNome2(nomeControle As String) 'UMA FUNÇÃO CRIADA PARA CHAMAR O DICIONÁRIO'

        'A FUNÇÃO USA A STRING DE REFERÊNCIA PARA PERCORRER O DIRETÓRIO EM BUSCA DA IMAGEM.'

        Pokeimagens() 'CHAMADA DO DICIONÁRIO.'

        If Pokepictures.ContainsKey(nomeControle) Then 'SE O DICIONÁRIO RECEBE A STRING DE REFERÊNCIA...
            PictureBox2_PLAYER2.Image = Image.FromFile(Pokepictures(nomeControle)) 'ELE RETORNA A IMAGEM REFERENTE A STRIN.'
        Else 'DO CONTRÁRIO...
            PictureBox2_PLAYER2.Image = Nothing 'NADA É RETORNADO.'
        End If

    End Sub
    Sub ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

        'OS BOTÕES SÃO DESABILITADOS ASSIM QUE EU ESCOLHO UM POKEMON.'



        listView1Vazia = (LISTVIEW1_PLAYER1.Items.Count = 0) 'VARIÁVEL PARA GUARDAR A CONTAGEM DE ITENS DE UMA LISTVIEW'
        listView2Vazia = (LISTVIEW2_PLAYER2.Items.Count = 0) 'VARIÁVEL PARA GUARDAR A CONTAGEM DE ITENS DE UMA LISTVIEW'

        'NESTE CASO A VARIÁVE GUARDA A CONTEGEM DE ZERO.'

        If listView1Vazia Then 'SE A LISTVIEW ESTIVER VAZIA.'
            BUTTON_ESCOLHER_POKEMON_P1.Enabled = True 'O BOTÃO ESTARÁ HABILITADO.'
        Else 'DO CONTRÁRIO...
            BUTTON_ESCOLHER_POKEMON_P1.Enabled = False 'O BOTÃO ESTARÁ DESABILITADO.'
        End If

        If listView2Vazia Then 'SE A LISTVIEW ESTIVER VAZIA.'
            BUTTON_ESCOLHER_POKEMON_P2.Enabled = True 'O BOTÃO ESTARÁ HABILITADO.'
        Else 'DO CONTRÁRIO...
            BUTTON_ESCOLHER_POKEMON_P2.Enabled = False 'O BOTÃO ESTARÁ DESABILITADO.'
        End If

        If BUTTON_STARTBATTLE.Text = "BATTLE" Then 'SE O BOTÃO DE START ESTIVER RECEBENDO O TEXT START...
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        End If

    End Sub

    Private Sub ExcluirPokemonDoTime1(nomeDoPokemon As String)                          'RECEBE O NOME DO POKEMON A SER EXCLUÍDO.'
        Try                                                                             'TENTE...
            conn.Open()                                                                 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
            Dim cmd As New MySqlCommand("DELETE FROM TIME1 WHERE NOME = @Nome;", conn)  'UM OBJETO PARA SELECIONAR UM NOME DE UM POKEMON DO TIME2.'
            cmd.Parameters.AddWithValue("@Nome", nomeDoPokemon)                         'O NOME DO POKEMON QUE ELE RECEBE SERÁ INSERIDO NA STRING @Nome.'
            cmd.ExecuteNonQuery()                                                       'EXECUTA A QUERY.'
            conn.Close()                                                                'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'
            PictureBox1_PLAYER1.Hide()                                                  'ESCONDE A FOTO'

            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'

        Catch ex As Exception                                                           'SE HOUVER ERRO...
            MessageBox.Show("Ocorreu um erro: " & ex.Message)                           'EXIBE A MENSAGEM.'
        Finally                                                                         'POR FIM...
            If conn.State = ConnectionState.Open Then                                   'SE A CONEXÃO SQL ESTIVER ABERTA...
                conn.Close()                                                            'FECHA A CONEXÃO.'
            End If
        End Try
    End Sub

    Private Sub ExcluirPokemonDoTime2(nomeDoPokemon As String)                          'RECEBE O NOME DO POKEMON A SER EXCLUÍDO.'
        Try                                                                             'TENTE...
            conn.Open()                                                                 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
            Dim cmd As New MySqlCommand("DELETE FROM TIME2 WHERE NOME = @Nome;", conn)  'UM OBJETO PARA SELECIONAR UM NOME DE UM POKEMON DO TIME2.'
            cmd.Parameters.AddWithValue("@Nome", nomeDoPokemon)                         'O NOME DO POKEMON QUE ELE RECEBE SERÁ INSERIDO NA STRING @Nome.'
            cmd.ExecuteNonQuery()                                                       'EXECUTA A QUERY.'
            conn.Close()                                                                'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'
            PictureBox2_PLAYER2.Hide()                                                  'ESCONDE A FOTO'
            ATTACK1_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        Catch ex As Exception                                                           'SE HOUVER ERRO...
            MessageBox.Show("Ocorreu um erro: " & ex.Message)                           'EXIBE A MENSAGEM.'
        Finally                                                                         'POR FIM...
            If conn.State = ConnectionState.Open Then                                   'SE A CONEXÃO SQL ESTIVER ABERTA...
                conn.Close()                                                            'FECHA A CONEXÃO.'
            End If
        End Try
    End Sub

    Private Sub Battle_Load(sender As Object, e As EventArgs) Handles MyBase.Load 'CARREGAMENTO DO FORM.'

        'NO CARREGAMENTO DO FORM AS COMBOBOXES DEVEM ESTAR SEMPRE PREENCHIDAS COM O ÚLTIMO TIME ESCOLHIDO.'
        'OS BOTÕES TAMBÉM DEVEM ESTAR CONFIGURADOS COM A PREFERÊNCIA DO UTILIZADOR.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        LoadComboBoxData() 'MÉTODO PARA ENCHER UMA COMBOBOX COM DADOS DO BANCO DE DADOS.'
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        LISTVIEW1_PLAYER1.Columns.Add("HP", 74)     'NOME DA COLUNA E LARGURA EM PIXELS.'
        LISTVIEW1_PLAYER1.Columns.Add("PP", 73)     'NOME DA COLUNA E LARGURA EM PIXELS.'
        LISTVIEW1_PLAYER1.Columns.Add("Status", 0) 'NOME DA COLUNA E LARGURA EM PIXELS.'
        LISTVIEW2_PLAYER2.Columns.Add("HP", 74)     'NOME DA COLUNA E LARGURA EM PIXELS.'
        LISTVIEW2_PLAYER2.Columns.Add("PP", 73)     'NOME DA COLUNA E LARGURA EM PIXELS.'
        LISTVIEW2_PLAYER2.Columns.Add("Status", 0) 'NOME DA COLUNA E LARGURA EM PIXELS.'

        timer.Interval = 1000 ' Define o intervalo do timer para 1 segundo (1000 milissegundos)
        AddHandler timer.Tick, AddressOf Timer_Tick ' Associa o evento Tick do Timer à função Timer_Tick

        If BUTTON_STARTBATTLE.Text = "START" Then 'SE O BOTÃO DE START ESTIVER RECEBENDO O TEXT START...
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        End If

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'



    End Sub

    Private Sub Timer_Tick(sender As Object, e As EventArgs) 'SUB CRIADA PARA DELIMITAR INÍCIO E FIM DE PARTIDA.'

        BattleCount += 1 'INCREMENTA O CONTADOR A CADA INTERVALO DO TIMER.'
        LabelContador.Text = "" & BattleCount 'ATUALIZA A LABEL COM O VALOR DO CONTADOR.'

        If ComboBox1_TIMEPLAYER1.Items.Count = 0 OrElse ComboBox2_TIMEPLAYER2.Items.Count = 0 Then 'SE UMA DAS COMBOBOXES ESTIVEREM VAZIAS.'
            timer.Stop() 'PARA O TIMER.'
            MessageBox.Show("FIM DA PARTIDA.")  'EXIBE A MENSAGEM.'
            BUTTON_STARTBATTLE.Enabled = True   'REATIVA O BOTÃO DE START.'
            BUTTON_STARTBATTLE.Text = "START"   'MUDA O TEXTO DO BOTÃO DE START PARA START.'
            ESCOLHERTIME_PLAYER1.Enabled = True 'BOTÃO DE TIME1 DESABILITADO.'
            ESCOLHERTIME_PLAYER2.Enabled = True 'BOTÃO DE TIME1 DESABILITADO.'
            Me.Hide()
            ChampionScreen.Show()
        End If

        If BUTTON_STARTBATTLE.Text = "START" Then 'SE O BOTÃO DE START ESTIVER RECEBENDO O TEXT START...
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        End If

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

    End Sub

    Private Sub ESCOLHERTIME_PLAYER1_Click(sender As Object, e As EventArgs) Handles ESCOLHERTIME_PLAYER1.Click

        'LEVA DIRETAMENTE AO FORM3 ENQUANTO ESCONDE O FORM1'
        'APAGA O CONTEÚDO DA COMBOBOX PARA QUE SEJA INSERIDO UM NOVO TIME1.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM1.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM3.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME3 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM2.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM4.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        Me.Hide()    'ESCONDE O FORM1.'
        Choice.Show() 'EXIBE O FORM3.'
        BUTTON_ESCOLHER_POKEMON_P1.Enabled = True 'HABILITA O BOTÃO DE ESCOLHER'

    End Sub

    Private Sub ESCOLHERTIME_PLAYER2_Click(sender As Object, e As EventArgs) Handles ESCOLHERTIME_PLAYER2.Click

        'LEVA DIRETAMENTE AO FORM3 ENQUANTO ESCONDE O FORM1'
        'APAGA O CONTEÚDO DA COMBOBOX PARA QUE SEJA INSERIDO UM NOVO TIME2.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM2.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM4.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM1.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME1 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        conn.Open()  'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'
        DELETETEAM3.SelectCommand.ExecuteNonQuery() 'EXECUTA A CONSULTA DO ADAPTADOR PARA ESVAZIAR A TABELA TIME3 DO BANCO DE DADOS.' 
        conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        Me.Hide()    'ESCONDE O FORM1.'
        Choice.Show() 'EXIBE O FORM3.'

    End Sub

    Private Sub Form1_Activated(sender As Object, e As EventArgs) Handles MyBase.Activated

        'ESTE FORM SERVE PARA MANTER AS CONFIGURAÇÕES DA TELA ATUALIZADAS ENQUANTO EU NAVEGO ENTRE OS FORMULÁRIOS.'
        'AQUI, ALGUMAS INSTRUÇÕES E CONDIÇÕES TÊM DE SER MANTIDAS PARA QUE O PROGRAMA NÃO RETOME AS CONFIGURAÇÕES DEFAULT ENQUANTO HÁ MANIPULAÇÃO DO PROGRAMA PELO UTILIZADOR.'

        Try 'TENTE...
            selectedPokemon1 = ComboBox1_TIMEPLAYER1.SelectedValue.ToString() 'SALVA O POKEMON SELECIONADO ANTES DE ATUALIZAR A COMBOBOX1.'
            selectedPokemon2 = ComboBox2_TIMEPLAYER2.SelectedValue.ToString() 'SALVA O POKEMON SELECIONADO ANTES DE ATUALIZAR A COMBOBOX2.'
            LoadComboBoxData() 'ATUALIZA AS COMBOBOXES.'
            ComboBox1_TIMEPLAYER1.SelectedValue = selectedPokemon1 'RESTAURA O POKEMON SELECIONADO NA COMBOBOX1 APÓS A ATUALIZAÇÃO.'
            ComboBox2_TIMEPLAYER2.SelectedValue = selectedPokemon2 'RESTAURA O POKEMON SELECIONADO NA COMBOBOX2 APÓS A ATUALIZAÇÃO.'
            ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'
        Catch 'SE NÃO FUNCIONAR...
            If ComboBox1_TIMEPLAYER1.Items.Count = 0 Then                          'SE A COMBOBOX ESTIVER VAZIA...
            Else                                                                   'DO CONTRÁRIO...
                ComboBox1_TIMEPLAYER1.ValueMember = "NOME"                         'O CAMPO NOME DO OBJETO ESTÁ RELACIONADO AO ITEM DENTRO DA PROPRIEDADE.'
                selectedPokemon1 = ComboBox1_TIMEPLAYER1.SelectedValue.ToString()  'RESTAURA O POKEMON SELECIONADO NA COMBOBOX1 APÓS A ATUALIZAÇÃO.'
                LoadComboBoxData()                                                 'ATUALIZA AS COMBOBOXES.'
                ComboBox1_TIMEPLAYER1.SelectedValue = selectedPokemon1             'RESTAURA O POKEMON SELECIONADO NA COMBOBOX1 APÓS A ATUALIZAÇÃO.'
                ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'
            End If
            If ComboBox2_TIMEPLAYER2.Items.Count = 0 Then                          'SE A COMBOBOX ESTIVER VAZIA...
            Else                                                                   'DO CONTRÁRIO...
                ComboBox2_TIMEPLAYER2.ValueMember = "NOME"                         'O CAMPO NOME DO OBJETO ESTÁ RELACIONADO AO ITEM DENTRO DA PROPRIEDADE.'
                selectedPokemon2 = ComboBox2_TIMEPLAYER2.SelectedValue.ToString()  'RESTAURA O POKEMON SELECIONADO NA COMBOBOX1 APÓS A ATUALIZAÇÃO.'
                LoadComboBoxData()                                                 'ATUALIZA AS COMBOBOXES.'
                ComboBox2_TIMEPLAYER2.SelectedValue = selectedPokemon2             'RESTAURA O POKEMON SELECIONADO NA COMBOBOX1 APÓS A ATUALIZAÇÃO.'
                ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'
            End If
        End Try

        'ATUALIZAÇÃO DE STATUS DO POKÉMON ENCAPSULADO.'
        'O ESTADO ENCAPSULADO TÊM LIGAÇÃO DIRETA COM A CONFIGURAÇÃO DE BOTÕES...
        'POR ISSO ESTES BOTÕES TÊM SEMPRE DE TER SEUS COMPORTAMENTOS ALTERADOS E MANTIDOS AQUI.'

        If BUTTON_STATUS_PLAYER2.Text = "ENCAPSULADO" Then 'SE O PLAYER1 ESTIVER ENCAPSULADO...
            ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
        Else 'DO CONTRÁRIO...
            ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
        End If

        If BUTTON_STATUS_PLAYER1.Text = "ENCAPSULADO" Then
            ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
        Else 'DO CONTRÁRIO...
            ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
        End If

        'ATUALIZAÇÃO DO STATUS DE DESABILITADO.'
        'O ESTADO DESABILITADO TÊM LIGAÇÃO DIRETA COM A CONFIGURAÇÃO DE BOTÕES...
        'POR ISSO ESTES BOTÕES TÊM SEMPRE DE TER SEUS COMPORTAMENTOS ALTERADOS E MANTIDOS AQUI.'
        'A TÉCNICA DISABLE DESABILITA UM BOTÃO DE ATAQUE ALEATÓRIO.'
        'O RESULTADO DESTA ALEATORIEDADE FOI GUARDADA EM UMA VARIÁVEL RANDOM QUE SE COMPORTA DE 4 FORMAS DIFERENTES...
        'PARA CADA UMA DAS 4 SITUAÇÕES.

        Select Case configuracaoBotao 'VARIÁVEL RANDOM DECLARADA NO PUBLIC CLASS.'
            Case 1 'SE A VARIÁVEL ME RETORNA O NÚMERO1.'
                ATTACK1_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 2 'SE A VARIÁVEL ME RETORNA O NÚMERO2.'
                ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 3 'SE A VARIÁVEL ME RETORNA O NÚMERO3.'
                ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 4 'SE A VARIÁVEL ME RETORNA O NÚMERO4.'
                ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
        End Select

        If BUTTON_STATUS_PLAYER2.Text = "NORMAL" Then 'SE O BOTÃO DE STATUS DO PLAYER2 ESTIVER COM O TEXTO 'NORMAL...
            ATTACK1_PLAYER2.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
        End If

        'ATUALIZAÇÃO DO STATUS DE DESABILITADO.'
        'O ESTADO DESABILITADO TÊM LIGAÇÃO DIRETA COM A CONFIGURAÇÃO DE BOTÕES...
        'POR ISSO ESTES BOTÕES TÊM SEMPRE DE TER SEUS COMPORTAMENTOS ALTERADOS E MANTIDOS AQUI.'
        'A TÉCNICA DISABLE DESABILITA UM BOTÃO DE ATAQUE ALEATÓRIO.'
        'O RESULTADO DESTA ALEATORIEDADE FOI GUARDADA EM UMA VARIÁVEL RANDOM QUE SE COMPORTA DE 4 FORMAS DIFERENTES...
        'PARA CADA UMA DAS 4 SITUAÇÕES.

        Select Case configuracaoBotao 'VARIÁVEL RANDOM DECLARADA NO PUBLIC CLASS.'
            Case 1 'SE A VARIÁVEL ME RETORNA O NÚMERO1.'
                ATTACK1_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 2 'SE A VARIÁVEL ME RETORNA O NÚMERO2.'
                ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 3 'SE A VARIÁVEL ME RETORNA O NÚMERO3.'
                ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Case 4 'SE A VARIÁVEL ME RETORNA O NÚMERO4.'
                ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
        End Select

        If BUTTON_STATUS_PLAYER1.Text = "NORMAL" Then 'SE O BOTÃO DE STATUS DO PLAYER1 ESTIVER COM O TEXTO 'NORMAL...
            ATTACK1_PLAYER1.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = True 'EXIBE BOTÃO DE ATAQUE.'
        End If

        'ATUALIZAÇAO DOS BOTÕES APÓS APERTAR START.'
        'QUANDO O BOTÃO DE START FOR APERTADO ELE MUDA SEU NOME...
        'QUANDO SEU NOME MUDAR VERIFICA-SE QUAL DOS DOIS JOGADORES COMEÇA A PARTIDA...
        '50% DE CHANCE DE UM JOGADOR TER SEUS BOTÃO ESCONDIDOS PARA DAR A CHANCE DO OUTRO COMEÇAR A ATACAR.'

        If BUTTON_STARTBATTLE.Text = "LUTAR" Then 'NOME DO BOTÃO START MUDA PARA LUTAR.'
            If hidebuttons < 0.5 Then 'VARIÁVEL DECLARADA EM PUBLIC CLASS PARA GUARDAR UMA PROBABILIDADE RANDOM.'
                ATTACK1_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK1_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'  
                ATTACK2_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
            Else
                ATTACK1_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER1.Visible = True  'EXIBE BOTÃO DE ATAQUE.'
                ATTACK1_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK2_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK3_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
                ATTACK4_PLAYER2.Visible = False 'ESCONDE BOTÃO DE ATAQUE.'
            End If
        End If

        If BUTTON_STARTBATTLE.Text = "START" Then 'SE O BOTÃO DE START ESTIVER RECEBENDO O TEXT START...
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        End If

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

    End Sub

    Private Sub SetMoveButtonText(moveNumber As Integer, moveName As String)

        'A FUNÇÃO É RESPONSÁVEL POR ATUALIZAR O TEXTO DOS BOTÕES DE ATAQUE DO JOGADOR1.'
        'ELA RECEBE UM VALOR PARA GUARDAR O NÚMERO DO MOVIMENTO...
        'E OUTRO VALOR PARA DEFINIR O NOME DO BOTÃO DE ATAQUE.

        Select Case moveNumber
            Case 1                              'EM CASO DO NÚMERO SER O 1.'
                ATTACK1_PLAYER1.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 2                              'EM CASO DO NÚMERO SER O 2.'
                ATTACK2_PLAYER1.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 3                              'EM CASO DO NÚMERO SER O 3.'
                ATTACK3_PLAYER1.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 4                              'EM CASO DO NÚMERO SER O 4.'
                ATTACK4_PLAYER1.Text = moveName 'BOTÃO RECEBE STRING.'
        End Select
    End Sub

    Private Sub SetMoveButtonText2(moveNumber As Integer, moveName As String)
        'A FUNÇÃO É RESPONSÁVEL POR ATUALIZAR O TEXTO DOS BOTÕES DE ATAQUE DO JOGADOR2.'
        'ELA RECEBE UM VALOR PARA GUARDAR O NÚMERO DO MOVIMENTO...
        'E OUTRO VALOR PARA DEFINIR O NOME DO BOTÃO DE ATAQUE.
        Select Case moveNumber
            Case 1                              'EM CASO DO NÚMERO SER O 1.'
                ATTACK1_PLAYER2.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 2                              'EM CASO DO NÚMERO SER O 2.'
                ATTACK2_PLAYER2.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 3                              'EM CASO DO NÚMERO SER O 3.'
                ATTACK3_PLAYER2.Text = moveName 'BOTÃO RECEBE STRING.'
            Case 4                              'EM CASO DO NÚMERO SER O 4.'
                ATTACK4_PLAYER2.Text = moveName 'BOTÃO RECEBE STRING.'
        End Select
    End Sub

    Private Sub AplicarAtaqueNoPokemon1(ByVal attackName As String, ByVal damage As Integer, ByVal attackType As String)

        'NAS CONDIÇÃO O NOME DOS ATAQUES SERÃO VERIFICADOS...
        'É CRIADA UMA VARIÁVEL INTEIRO PARA RECEBER O DANO REFERENTE AO NOME DO ATAQUE.'
        'EXIBE UMA MENSAGEM PARA MOSTRAR AO UTILIZADOR QUAL ATAQUE FOI ESCOLHIDO E QUANTO DE DANO ELE TIROU.'
        'UM LOOP É CRIADO PARA ITERAR SOBRE A LISTVIEW.'
        'DENTRO DO LOOP UMA VARIÁVEL É CRIADA PARA RECEBER O VALOR DO HP DO POKEMON DO OUTRO LADO.'
        'CONVERTE O VALOR DE TEXTO DO HP PARA INTEIRO.'
        'CRIA UMA VARIÁVEL QUE RECEBE O VALOR DA FUNÇÃO DE CÁLCULO DE DANO.'
        'UMA CONDIÇÃO É CRIADA PARA SABER SE A VARIÁVEL DA FUNÇÃO FOI IMPLEMENTADA.'
        'REDUZ OS PONTOS DE VIDA DO POKEMON COM BASE NO DANO DO ATAQUE.'
        'SE OS PONTOS DE VIDA DO POKEMON CHEGAREM A ZERO.'
        'LIMPA A LISTVIEW.'
        'E SE UM POKEMON ESTÁ SELECIONADO À COMBOBOX...
        'CRIA UMA VARIÁVEL QUE RECEBE O QUE ESTÁ ESCRITO DENTRO DA COMBOBOX2.'
        'CONVERTE O QUE ESTÁ ESCRITO PARA STRING.'
        'CHAMA A FUNÇÃO PARA EXCLUIR O POKEMON DO TIME1.'
        'ATUALIZA A COMBOBOX1 E INDEXA ELA COMO NÃO SELECIONADA.'
        'ATUALIZA O VALOR DO HP DO POKEMON DO TIME2 DENTRO DA LISTVIEW.'
        'SAI DO LOOP.'
        'FECHA A CONDIÇÃO.'
        'O MESMO PROCEDIMENTO É REFEITO PARA SUBTRAIR O PP DO PLAYER2.'

        'STATUS DE MEDO'

        If BUTTON_STATUS_PLAYER2.Text = "MEDO" Then 'SE O POKEMON ESTÁ AMEDRONTADO.'
            damage = damage \ 2                     'SEU DANO CAI PELA METADE.'
        End If

        'STATUS DE AFIADO'

        If BUTTON_STATUS_PLAYER2.Text = "AFIADO" Then 'SE O POKEMON ESTÁ AFIADO.'
            damage = damage * 1.5                     'SE DANO RECEBE UM BÔNUS DE 50%'
        End If

        'STATUS DE CEGUEIRA'

        If BUTTON_STATUS_PLAYER2.Text = "CEGO" Then 'SE O POKEMON ESTÁ CEGO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon está CEGO!") 'O POKEMON ESTÁ CEGO E NÃO CONSEGUE ATACAR.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("O Pokémon consegue atacar!") 'O POKEMON CONSEGUE ATACAR E O RESTO DO CÓDIGO É EXECUTADO.'
            End If
        End If

        'STATUS DE PARALISIA'

        If BUTTON_STATUS_PLAYER2.Text = "PARALISADO" Then 'SE O POKEMON ESTÁ PARALISADO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then  'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon está Paralisado!") 'O POKEMON ESTÁ PARALISADO E NÃO CONSEGUE ATACAR.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("O Pokémon consegue atacar!") 'O POKEMON CONSEGUE ATACAR E O RESTO DO CÓDIGO É EXECUTADO.'
            End If
        End If

        'STATUS DE VELOZ'

        If BUTTON_STATUS_PLAYER1.Text = "VELOZ" Then 'SE O POKEMON INIMIGO ESTÁ VELOZ.'
            Dim random As New Random()  'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("Você errou o ataque!") 'ERROU O ATAQUE.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else
            End If
        End If

        'STATUS DE BLINDADO'

        If BUTTON_STATUS_PLAYER1.Text = "BLINDADO" Then 'SE O POKEMON INIMIGO ESTÁ BLINDADO.'
            damage = damage \ 2  'SEU DANO CAI PELA METADE.'
            MessageBox.Show("Defesa incrementada, seu ataque é pouco efetivo!") 'ATAQUE INEFICAZ.'
        End If

        'STATUS DE PROVOCAÇÃO'

        If BUTTON_STATUS_PLAYER1.Text = "PROVOCADO" Then 'SE O POKEMON INIMIGO ESTÁ PROVOCADO.'
            damage = damage * 1.5
            MessageBox.Show("Guarda aberta, seu ataque foi mais eficiente!") 'ATAQUE EFICIENTE.'
        End If

        'STATUS DE SONO'

        If BUTTON_STATUS_PLAYER2.Text = "SONO" Then 'SE O POKEMON ESTÁ DORMINDO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeAcordar As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeAcordar < 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon acordou") 'O POKEMON ACORDA.'
                BUTTON_STATUS_PLAYER2.Text = "NORMAL" 'SEU STATUS NORMALIZA.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else  'DO CONTRÁRIO...
                MessageBox.Show("O Pokémon continua dormindo") 'O POKEMON CONTINUA DORMINDO.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            End If
        End If

        'STATUS DE SEDUÇÃO'

        If BUTTON_STATUS_PLAYER2.Text = "SEDUZIDO" Then 'SE O POKEMON ESTIVER SEDUZIDO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.' 
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon se libertou do efeito SEDUZIDO!") 'O POKEMON SE LIBERTA DO EFEITO.'
                BUTTON_STATUS_PLAYER2.Text = "NORMAL" 'O EFEITO PASSA.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("Você não consegue agredir o Pokémon, ao invés disso, oferece a ele um doce que cura: " & damage.ToString() & " de HP") 'EXIBE MENSAGEM'

                'O CÓDIGO DE ATAQUE É IMPLEMENTADO, PORÉM...
                'AO INVÉS DE INFLIGIR DANO, ELE VAI CURAR O POKEMON INIMIGO.'
                'O POKEMON SEDUZIDO OFERECE UM DOCE AO INIMIGO QUE CURA O SEU HP.'
                'AO INVÉS DE DEBITAR O DAMAGE DO HP, SIMPLESMENTE ACRESCENTA-SE UM VALOR DE DAMAGE FIXO AO HP.'

                For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items
                    Dim hpValue As Integer
                    If Integer.TryParse(item.Text, hpValue) Then
                        Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                        Dim resultadoDano = CalcularDano(attackType, pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo
                        If superEfetivo Then
                            MessageBox.Show("SUPER EFETIVO!")
                        End If
                        hpValue += calculatedDamage
                        If hpValue <= 0 Then
                            LISTVIEW1_PLAYER1.Items.Remove(item)
                            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then
                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()
                                ExcluirPokemonDoTime1(selectedPokemon2)
                                ComboBox1_TIMEPLAYER1.Refresh()
                                ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                                LoadComboBoxData()
                            End If
                        End If
                        item.Text = hpValue.ToString()
                        Exit For
                    End If
                Next
                Dim pokemonToRemovePlayer3 As New List(Of ListViewItem)
                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items
                    If item2.SubItems.Count >= 2 Then
                        Dim mpValue As Integer
                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then
                            mpValue -= 10
                            item2.SubItems(1).Text = mpValue.ToString()
                            If mpValue <= 0 Then
                                pokemonToRemovePlayer3.Add(item2)
                            End If
                        End If
                    End If
                Next
                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer3
                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)
                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then
                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()
                        ExcluirPokemonDoTime2(selectedPokemon1)
                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                        LoadComboBoxData()
                    End If
                Next
                Return
            End If
        End If

        'STATUS DE CONFUSÃO'

        If BUTTON_STATUS_PLAYER2.Text = "CONFUSO" Then 'SE O POKEMON ESTÁ CONFUSO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.' 
            Dim chanceDeAcordar As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeAcordar < 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon não está mais confuso") 'O POKEMON SE LIBERTA DO EFEITO.'
                BUTTON_STATUS_PLAYER2.Text = "NORMAL" 'SEU STATUS NORMALIZA.'
                damage = 0
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...

                'O CÓDIGO DE ATAQUE É IMPLEMENTADO, PORÉM...
                'AO INVÉS DE INFLIGIR DANO, ELE SE ATACAR.'

                MessageBox.Show("O Pokémon está confuso e se atacou")
                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())
                For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items
                    Dim hpValue As Integer
                    If Integer.TryParse(item.Text, hpValue) Then
                        Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                        Dim resultadoDano = CalcularDano(attackType, pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo
                        If superEfetivo Then
                            MessageBox.Show("SUPER EFETIVO!")
                        End If
                        hpValue -= calculatedDamage
                        If hpValue <= 0 Then
                            LISTVIEW2_PLAYER2.Items.Remove(item)
                            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then
                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()
                                ExcluirPokemonDoTime2(selectedPokemon2)
                                ComboBox2_TIMEPLAYER2.Refresh()
                                ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                                LoadComboBoxData()
                            End If
                        End If
                        item.Text = hpValue.ToString()
                        Exit For
                    End If
                Next
                Dim pokemonToRemovePlayer3 As New List(Of ListViewItem)
                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items
                    If item2.SubItems.Count >= 2 Then
                        Dim mpValue As Integer
                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then
                            mpValue -= 10
                            item2.SubItems(1).Text = mpValue.ToString()
                            If mpValue <= 0 Then
                                pokemonToRemovePlayer3.Add(item2)
                            End If
                        End If
                    End If
                Next
                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer3
                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)
                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then
                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()
                        ExcluirPokemonDoTime2(selectedPokemon1)
                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                        LoadComboBoxData()
                    End If
                Next
                Return
            End If
        End If

        'DANO PADRÃO'

        MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString()) 'EXIBE UMA MENSAGEM QUE RECEBE A STRING DO NOME DO ATAQUE E UM NÚMERO INTEIRO DO DANO A CALCULAR.'
        For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items 'UM LOOP É CRIADO PARA PERCORRER A LISTVIEW DO POKEMON ADVERSÁRIO.'
            Dim hpValue As Integer 'DECLARA A VARIÁVEL DO HP DO POKEMON.'
            If Integer.TryParse(item.Text, hpValue) Then 'TRANSFORMA hpValue VARIÁVEL EM TEXTO.'
                Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text 'CRIA UMA VARIÁVEL STRING PARA RECEBER O QUE ESTÁ ESCRITO NO BOTÃO DE TIPO DE POKEMON.'
                Dim resultadoDano = CalcularDano(attackType, pokemonType, damage) 'CRIA UMA VARIÁVEL QUE RECEBE A FUNÇÃO PARA CALCULAR O DANO, QUE RECEBE O TIPO DE ATAQUE, O TIPO DE POKEMON E O DANO.'
                Dim calculatedDamage As Integer = resultadoDano.damage 'CRIA UMA VARIÁVEL PARA RECEBER A resultadoDano PARA SER CALCULADO.'
                Dim superEfetivo As Boolean = resultadoDano.superEfetivo 'CRIA UMA VARIÁVEL PARA RECEBER A resultadoDano PARA SABER SE FOI SUPER EFEITIVO.'
                If superEfetivo Then 'SE O RESULTADO BOLEANO DE superEfetivo FOR VERDADEIRO.'
                    MessageBox.Show("SUPER EFETIVO!") 'EXIBE MENSAGEM.'
                End If
                hpValue -= calculatedDamage 'O DANO CALCULADO É REMOVIDO DO HP DO POKÉMON ADVERSÁRIO.'
                If hpValue <= 0 Then 'SE O HP DO POKÉMON ADVERSÁRIO FOR MENOR OU IGUAL A 0.'
                    LISTVIEW1_PLAYER1.Items.Remove(item) 'REMOVE O POKEMON DA LISTVIEW.'
                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then 'SE O POKÉMON SAI DA COMBOBOX DERROTADO.'
                        Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView) 'CRIA UMA VARIÁVEL PARA RECEBER O VALOR DO ITEM SELECIONADO NA COMBOBOX.'
                        Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString() 'PASSA ESTE VALOR PARA STRING.'
                        ExcluirPokemonDoTime1(selectedPokemon2) 'CHAMA A FUNÇÃO PARA EXCLUIR POKEMON.'
                        ComboBox1_TIMEPLAYER1.Refresh() 'ATUALIZA A COMBOBOX.'
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1 'SELECIONA A COMBOBOX COMO VAZIA.'
                        LoadComboBoxData() 'CARREGA NOVAMENTE A COMBOBOX.'
                    End If
                End If
                item.Text = hpValue.ToString() 'PASSA O VALOR DO ITEM DA LISTVIEW PARA STRING.'
                Exit For
            End If
        Next
        Dim pokemonToRemovePlayer2 As New List(Of ListViewItem) 'CRIA UMA VARIÁVEL QUE RECEBE UMA LISTA.'
        For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items 'UM LOOP PARA PERCORRER O ITEM DA PRÓPRIA LISTVIEW.'
            If item2.SubItems.Count >= 2 Then 'SE A COLUNA ONDE ESTÁ O PP....
                Dim mpValue As Integer 'VARIÁVEL PARA RECEBER O VALOR DO PP.'
                If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then 'PASSA O VALOR NUMÉRICO DO PP PARA STRING.'
                    mpValue -= 10 'VALOR DEBITADO DO PP.'
                    item2.SubItems(1).Text = mpValue.ToString() 'PASSA O VALOR DEBITADO PARA STRING.'
                    If mpValue <= 0 Then 'SE O PP FOR MENOR OU IGUAL A ZERO.'
                        pokemonToRemovePlayer2.Add(item2) 'REMOVE O ITEM DA LISTVIEW.'
                    End If
                End If
            End If
        Next
        For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2 'CRIA UMA VARIÁVEL QUE RECEBE O VALOR DEBITADO DA LISTA.'
            LISTVIEW2_PLAYER2.Items.Remove(itemToRemove) 'REMOVE O ITEM DA LISTA.'
            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then 'SE A MINHA COMBOBOX ESTIVER VAZIA.'
                Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView) 'CRIA UMA VARIÁVEL PARA RECEBER O VALOR DO ITEM SELECIONADO NA COMBOBOX.'
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()  'PASSA ESTE VALOR PARA STRING.'
                ExcluirPokemonDoTime2(selectedPokemon1) 'CHAMA A FUNÇÃO PARA EXCLUIR POKEMON.'
                ComboBox2_TIMEPLAYER2.Refresh()  'ATUALIZA A COMBOBOX.'
                ComboBox2_TIMEPLAYER2.SelectedIndex = -1 'SELECIONA A COMBOBOX COMO VAZIA.'
                LoadComboBoxData() 'CARREGA NOVAMENTE A COMBOBOX.'
            End If
        Next
    End Sub

    Function CalcularDano(attackType As String, pokemonType As String, damage As Integer) As (damage As Integer, superEfetivo As Boolean)

        'ESTA FUNÇÃO É CRIADA PARA DESIGNAR AS VULNERABILIDADES DE ELEMENTOS ENTRE OS POKEMONS.'
        'ELA RECEBE PARÂMETROS QUE SÃO COMPARADOS A OUTROS PARA QUE O DANO SEJA IMPLEMENTADO DE FORMA CORRETA.'

        Dim superEfetivo As Boolean = False 'CRIA-SE UMA VARIÁVEL BOLEANA PARA VERIFICAR SE A FUNÇÃO FOR CHAMADA NO CÓDIGO.'
        If (attackType = "Água" AndAlso (pokemonType = "Fogo" Or pokemonType = "Pedra" Or pokemonType = "Terra")) Or
       (attackType = "Fogo" AndAlso (pokemonType = "Grama" Or pokemonType = "Gelo" Or pokemonType = "Inseto" Or pokemonType = "Aço")) Or
       (attackType = "Grama" AndAlso (pokemonType = "Terra" Or pokemonType = "Pedra" Or pokemonType = "Inseto" Or pokemonType = "Aço")) Or
       (attackType = "Elétrico" AndAlso (pokemonType = "Voador" Or pokemonType = "Água")) Or
       (attackType = "Gelo" AndAlso (pokemonType = "Grama" Or pokemonType = "Terra" Or pokemonType = "Voador" Or pokemonType = "Dragão")) Or
       (attackType = "Lutador" AndAlso (pokemonType = "Gelo" Or pokemonType = "Normal" Or pokemonType = "Pedra" Or pokemonType = "Dragão" Or pokemonType = "Aço")) Or
       (attackType = "Veneno" AndAlso (pokemonType = "Grama" Or pokemonType = "Fada")) Or
       (attackType = "Terra" AndAlso (pokemonType = "Fogo" Or pokemonType = "Elétrico" Or pokemonType = "Veneno" Or pokemonType = "Pedra" Or pokemonType = "Aço")) Or
       (attackType = "Voador" AndAlso (pokemonType = "Grama" Or pokemonType = "Lutador" Or pokemonType = "Inseto" Or pokemonType = "Pedra" Or pokemonType = "Aço")) Or
       (attackType = "Psíquico" AndAlso (pokemonType = "Lutador" Or pokemonType = "Veneno")) Or
       (attackType = "Inseto" AndAlso (pokemonType = "Grama" Or pokemonType = "Psíquico")) Or
       (attackType = "Pedra" AndAlso (pokemonType = "Gelo" Or pokemonType = "Voador" Or pokemonType = "Fogo" Or pokemonType = "Inseto")) Or
       (attackType = "Fantasma" AndAlso (pokemonType = "Psíquico" Or pokemonType = "Fantasma" Or pokemonType = "Fogo" Or pokemonType = "Inseto")) Or
       (attackType = "Dragão" AndAlso pokemonType = "Dragão") Or
       (attackType = "Aço" AndAlso (pokemonType = "Gelo" Or pokemonType = "Pedra" Or pokemonType = "Fada")) Then
            damage = CInt(damage * 1.5) 'SE A VARIÁVEL BOLEANA FOR VERDADEIRO O DANO SUPER EFETIVO SERÁ IMPLEMENTADO.'
            superEfetivo = True
        End If
        Return (damage, superEfetivo) 'RETORNA O VALOR DO DANO E A VARIÁVEL BOLEANA.'

    End Function

    Private Sub AplicarAtaqueNoPokemon2(ByVal attackName As String, ByVal damage As Integer, ByVal attackType As String)

        'NAS CONDIÇÃO O NOME DOS ATAQUES SERÃO VERIFICADOS...
        'É CRIADA UMA VARIÁVEL INTEIRO PARA RECEBER O DANO REFERENTE AO NOME DO ATAQUE.'
        'EXIBE UMA MENSAGEM PARA MOSTRAR AO UTILIZADOR QUAL ATAQUE FOI ESCOLHIDO E QUANTO DE DANO ELE TIROU.'
        'UM LOOP É CRIADO PARA ITERAR SOBRE A LISTVIEW.'
        'DENTRO DO LOOP UMA VARIÁVEL É CRIADA PARA RECEBER O VALOR DO HP DO POKEMON DO OUTRO LADO.'
        'CONVERTE O VALOR DE TEXTO DO HP PARA INTEIRO.'
        'CRIA UMA VARIÁVEL QUE RECEBE O VALOR DA FUNÇÃO DE CÁLCULO DE DANO.'
        'UMA CONDIÇÃO É CRIADA PARA SABER SE A VARIÁVEL DA FUNÇÃO FOI IMPLEMENTADA.'
        'REDUZ OS PONTOS DE VIDA DO POKEMON COM BASE NO DANO DO ATAQUE.'
        'SE OS PONTOS DE VIDA DO POKEMON CHEGAREM A ZERO.'
        'LIMPA A LISTVIEW.'
        'E SE UM POKEMON ESTÁ SELECIONADO À COMBOBOX...
        'CRIA UMA VARIÁVEL QUE RECEBE O QUE ESTÁ ESCRITO DENTRO DA COMBOBOX2.'
        'CONVERTE O QUE ESTÁ ESCRITO PARA STRING.'
        'CHAMA A FUNÇÃO PARA EXCLUIR O POKEMON DO TIME2.'
        'ATUALIZA A COMBOBOX2 E INDEXA ELA COMO NÃO SELECIONADA.'
        'ATUALIZA O VALOR DO HP DO POKEMON DO TIME2 DENTRO DA LISTVIEW.'
        'SAI DO LOOP.'
        'FECHA A CONDIÇÃO.'
        'O MESMO PROCEDIMENTO É REFEITO PARA SUBTRAIR O PP DO PLAYER1.'

        'STATUS DE MEDO'

        If BUTTON_STATUS_PLAYER1.Text = "MEDO" Then 'SE O POKEMON ESTÁ AMEDRONTADO.'
            damage = damage \ 2                     'SEU DANO CAI PELA METADE.'
        End If

        'STATUS DE AFIADO.'

        If BUTTON_STATUS_PLAYER1.Text = "AFIADO" Then 'SE O POKEMON ESTÁ AFIADO.'
            damage = damage * 1.5                     'SE DANO RECEBE UM BÔNUS DE 50%'
        End If

        'STATUS DE CEGUEIRA'

        If BUTTON_STATUS_PLAYER1.Text = "CEGO" Then 'SE O POKEMON ESTÁ CEGO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon está CEGO!") 'O POKEMON ESTÁ CEGO E NÃO CONSEGUE ATACAR.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else
                MessageBox.Show("O Pokémon consegue atacar!") 'O POKEMON CONSEGUE ATACAR E O RESTO DO CÓDIGO É EXECUTADO.'
            End If

            'STATUS DE VELOZ'

        End If
        If BUTTON_STATUS_PLAYER2.Text = "VELOZ" Then 'SE O POKEMON INIMIGO ESTÁ VELOZ.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then  'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("Você errou o ataque!") 'ERROU O ATAQUE.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else
            End If
        End If

        'STATUS DE PARALISIA'

        If BUTTON_STATUS_PLAYER1.Text = "PARALISADO" Then 'SE O POKEMON ESTÁ PARALISADO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon está Paralisado!") 'O POKEMON ESTÁ PARALISADO E NÃO CONSEGUE ATACAR.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("O Pokémon consegue atacar!") 'O POKEMON CONSEGUE ATACAR E O RESTO DO CÓDIGO É EXECUTADO.'
            End If
        End If

        'STATUS DE BLINDADO'

        If BUTTON_STATUS_PLAYER2.Text = "BLINDADO" Then 'SE O POKEMON INIMIGO ESTÁ BLINDADO.'
            damage = damage \ 2 'SEU DANO CAI PELA METADE.'
            MessageBox.Show("Defesa incrementada, seu ataque é pouco efetivo!") 'ATAQUE INEFICAZ.'
        End If

        'STATUS DE PROVOCAÇÃO'

        If BUTTON_STATUS_PLAYER2.Text = "PROVOCADO" Then 'SE O POKEMON INIMIGO ESTÁ PROVOCADO.'
            damage = damage * 1.5
            MessageBox.Show("Guarda aberta, seu ataque foi mais eficiente!") 'ATAQUE EFICIENTE.'
        End If

        'STATUS DE SONO'

        If BUTTON_STATUS_PLAYER1.Text = "SONO" Then 'SE O POKEMON ESTÁ DORMINDO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
            Dim chanceDeAcordar As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeAcordar < 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon acordou") 'O POKEMON ACORDA.'
                BUTTON_STATUS_PLAYER1.Text = "NORMAL" 'SEU STATUS NORMALIZA.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("O Pokémon continua dormindo") 'O POKEMON CONTINUA DORMINDO.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            End If
        End If

        'STATUS DE SEDUÇÃO'

        If BUTTON_STATUS_PLAYER1.Text = "SEDUZIDO" Then 'SE O POKEMON ESTIVER SEDUZIDO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.' 
            Dim chanceDeLiberacao As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeLiberacao <= 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon se libertou do efeito SEDUZIDO!") 'O POKEMON SE LIBERTA DO EFEITO.'
                BUTTON_STATUS_PLAYER1.Text = "NORMAL" 'O EFEITO PASSA.'
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...
                MessageBox.Show("Você não consegue agredir o Pokémon, ao invés disso, oferece a ele um doce que cura: " & damage.ToString() & " de HP") 'EXIBE MENSAGEM'

                'O CÓDIGO DE ATAQUE É IMPLEMENTADO, PORÉM...
                'AO INVÉS DE INFLIGIR DANO, ELE VAI CURAR O POKEMON INIMIGO.'
                'O POKEMON SEDUZIDO OFERECE UM DOCE AO INIMIGO QUE CURA O SEU HP.'
                'AO INVÉS DE DEBITAR O DAMAGE DO HP, SIMPLESMENTE ACRESCENTA-SE UM VALOR DE DAMAGE FIXO AO HP.'

                For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items
                    Dim hpValue As Integer
                    If Integer.TryParse(item.Text, hpValue) Then
                        Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                        Dim resultadoDano = CalcularDano(attackType, pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo
                        If superEfetivo Then
                            MessageBox.Show("SUPER EFETIVO!")
                        End If
                        hpValue += calculatedDamage
                        If hpValue <= 0 Then
                            LISTVIEW2_PLAYER2.Items.Remove(item)
                            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then
                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()
                                ExcluirPokemonDoTime2(selectedPokemon2)
                                ComboBox2_TIMEPLAYER2.Refresh()
                                ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                                LoadComboBoxData()
                            End If
                        End If
                        item.Text = hpValue.ToString()
                        Exit For
                    End If
                Next
                Dim pokemonToRemovePlayer3 As New List(Of ListViewItem)
                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items
                    Dim mpValue As Integer
                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then
                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()
                        If mpValue <= 0 Then
                            pokemonToRemovePlayer3.Add(item2)
                        End If
                    End If
                Next
                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer3
                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)
                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then
                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()
                        ExcluirPokemonDoTime1(selectedPokemon1)
                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                        LoadComboBoxData()
                    End If
                Next
            End If
            Return
        End If

        'STATUS DE CONFUSÃO'

        If BUTTON_STATUS_PLAYER1.Text = "CONFUSO" Then 'SE O POKEMON ESTÁ CONFUSO.'
            Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.' 
            Dim chanceDeAcordar As Double = random.NextDouble() 'CRIA UMA VARIÁVEL DECIMAL QUE RECEBE A PORCENTAGEM DO RANDOM.'
            If chanceDeAcordar < 0.5 Then 'SE A VARIÁVEL RECEBER MENOS DE 50%'
                MessageBox.Show("O Pokémon não está mais confuso") 'O POKEMON SE LIBERTA DO EFEITO.'
                BUTTON_STATUS_PLAYER1.Text = "NORMAL" 'SEU STATUS NORMALIZA.'
                damage = 0
                Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
            Else 'DO CONTRÁRIO...

                'O CÓDIGO DE ATAQUE É IMPLEMENTADO, PORÉM...
                'AO INVÉS DE INFLIGIR DANO, ELE SE ATACAR.'

                MessageBox.Show("O Pokémon está confuso e se atacou")
                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())
                For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items
                    Dim hpValue As Integer
                    If Integer.TryParse(item.Text, hpValue) Then
                        Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                        Dim resultadoDano = CalcularDano(attackType, pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo
                        If superEfetivo Then
                            MessageBox.Show("SUPER EFETIVO!")
                        End If
                        hpValue -= calculatedDamage
                        If hpValue <= 0 Then
                            LISTVIEW1_PLAYER1.Items.Remove(item)
                            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then
                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()
                                ExcluirPokemonDoTime1(selectedPokemon2)
                                ComboBox1_TIMEPLAYER1.Refresh()
                                ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                                LoadComboBoxData()
                            End If
                        End If
                        item.Text = hpValue.ToString()
                        Exit For
                    End If
                Next
                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)
                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items
                    Dim mpValue As Integer
                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then
                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()
                        If mpValue <= 0 Then
                            pokemonToRemovePlayer2.Add(item2)
                        End If
                    End If
                Next
                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2
                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)
                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then
                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()
                        ExcluirPokemonDoTime1(selectedPokemon1)
                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                        LoadComboBoxData()
                    End If
                Next
                Return
            End If
        End If

        'DANO PADRÃO'

        MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString()) 'EXIBE UMA MENSAGEM QUE RECEBE A STRING DO NOME DO ATAQUE E UM NÚMERO INTEIRO DO DANO A CALCULAR.'
        For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items 'UM LOOP É CRIADO PARA PERCORRER A LISTVIEW DO POKEMON ADVERSÁRIO.'
            Dim hpValue As Integer 'DECLARA A VARIÁVEL DO HP DO POKEMON.'
            If Integer.TryParse(item.Text, hpValue) Then 'TRANSFORMA hpValue VARIÁVEL EM TEXTO.'
                Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text 'CRIA UMA VARIÁVEL STRING PARA RECEBER O QUE ESTÁ ESCRITO NO BOTÃO DE TIPO DE POKEMON.'
                Dim resultadoDano = CalcularDano(attackType, pokemonType, damage) 'CRIA UMA VARIÁVEL QUE RECEBE A FUNÇÃO PARA CALCULAR O DANO, QUE RECEBE O TIPO DE ATAQUE, O TIPO DE POKEMON E O DANO.'
                Dim calculatedDamage As Integer = resultadoDano.damage 'CRIA UMA VARIÁVEL PARA RECEBER A resultadoDano PARA SER CALCULADO.'
                Dim superEfetivo As Boolean = resultadoDano.superEfetivo 'CRIA UMA VARIÁVEL PARA RECEBER A resultadoDano PARA SABER SE FOI SUPER EFEITIVO.'
                If superEfetivo Then 'SE O RESULTADO BOLEANO DE superEfetivo FOR VERDADEIRO.'
                    MessageBox.Show("SUPER EFETIVO!") 'EXIBE MENSAGEM.'
                End If
                hpValue -= calculatedDamage 'O DANO CALCULADO É REMOVIDO DO HP DO POKÉMON ADVERSÁRIO.'
                If hpValue <= 0 Then 'SE O HP DO POKÉMON ADVERSÁRIO FOR MENOR OU IGUAL A 0.'
                    LISTVIEW2_PLAYER2.Items.Remove(item) 'REMOVE O POKEMON DA LISTVIEW.'
                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then 'SE O POKÉMON SAI DA COMBOBOX DERROTADO.'
                        Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView) 'CRIA UMA VARIÁVEL PARA RECEBER O VALOR DO ITEM SELECIONADO NA COMBOBOX.'
                        Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()  'PASSA ESTE VALOR PARA STRING.'
                        ExcluirPokemonDoTime2(selectedPokemon2) 'CHAMA A FUNÇÃO PARA EXCLUIR POKEMON.'
                        ComboBox2_TIMEPLAYER2.Refresh() 'ATUALIZA A COMBOBOX.'
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1 'SELECIONA A COMBOBOX COMO VAZIA.'
                        LoadComboBoxData() 'CARREGA NOVAMENTE A COMBOBOX.'
                    End If
                End If
                item.Text = hpValue.ToString() 'PASSA O VALOR DO ITEM DA LISTVIEW PARA STRING.'
                Exit For
            End If
        Next
        Dim pokemonToRemovePlayer1 As New List(Of ListViewItem) 'CRIA UMA VARIÁVEL QUE RECEBE UMA LISTA.'
        For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items 'UM LOOP PARA PERCORRER O ITEM DA PRÓPRIA LISTVIEW.'
            Dim mpValue As Integer 'CRIA UMA VARIÁVEL INTEIRO.'
            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then 'SE O MP FOR INTEIRO...
                mpValue -= 10 'VALOR DEBITADO DO PP.'
                item2.SubItems(1).Text = mpValue.ToString() 'PASSA O VALOR DEBITADO PARA STRING.'
                If mpValue <= 0 Then 'SE O PP FOR MENOR OU IGUAL A ZERO.'
                    pokemonToRemovePlayer1.Add(item2) 'REMOVE O ITEM DA LISTVIEW.'
                End If
            End If
        Next
        For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1 'CRIA UMA VARIÁVEL QUE RECEBE O VALOR DEBITADO DA LISTA.'
            LISTVIEW1_PLAYER1.Items.Remove(itemToRemove) 'REMOVE O ITEM DA LISTA.'
            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then 'SE A MINHA COMBOBOX ESTIVER VAZIA.'
                Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView) 'CRIA UMA VARIÁVEL PARA RECEBER O VALOR DO ITEM SELECIONADO NA COMBOBOX.'
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString() 'PASSA ESTE VALOR PARA STRING.'
                ExcluirPokemonDoTime1(selectedPokemon1) 'CHAMA A FUNÇÃO PARA EXCLUIR POKEMON.'
                ComboBox1_TIMEPLAYER1.Refresh()  'ATUALIZA A COMBOBOX.'
                ComboBox1_TIMEPLAYER1.SelectedIndex = -1 'SELECIONA A COMBOBOX COMO VAZIA.'
                LoadComboBoxData() 'CARREGA NOVAMENTE A COMBOBOX.'
            End If
        Next
    End Sub

    Private Sub BUTTON_ESCOLHER_POKEMON_P1_Click(sender As Object, e As EventArgs) Handles BUTTON_ESCOLHER_POKEMON_P1.Click

        BUTTON_STATUS_PLAYER1.Text = "NORMAL" 'QUANDO O SE ESCOLHE UM POKEMON, AUTOMATICAMENTE SEU STATUS PASSA PRA NORMAL.'

        'ESTE BOTÃO INSERE O POKEMON DENTRO DA COMBOBOX PRO LISTVIEW E DISTRIBUI OS SEUS MOVIMENTO ENTRE OS BOTÓES DE ATAQUE.'

        Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

        'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
        'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

        If selectedDataRowView IsNot Nothing Then
            Dim selectedPokemon As String = selectedDataRowView("NOME").ToString()

            'SE A VARIÁVEL NÃO FOR NULA ENTÃO...
            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            MessageBox.Show("Você selecionou: " & selectedPokemon) 'MENSAGEM PARA VERIFICAR SE ALGUM POKEMON FOI ESCOLHIDO.'

            Dim LISTVIEW1 As String = "SELECT HP, MP, PSTATUS FROM TIME1 WHERE NOME = @Nome" 'CRIA UMA STRING DE UMA CONSULTA SQL.'

            conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

            Dim cmd As New MySqlCommand(LISTVIEW1, conn) 'CRIA UM NOVO OBJETO ASSOCIADO À CONSULTA SQL.'

            cmd.Parameters.AddWithValue("@Nome", selectedPokemon)

            'ADICIONA O PARÂMETRO @NOME À CONSULTA SQL E ASSOCIA A ELE O VALOR DA VARIÁVEL.'
            'ISSO É FEITO PARA QUE O @NOME TENHA UMA REFERÊNCIA PARA A CONSULTA.'

            Dim reader As MySqlDataReader = cmd.ExecuteReader()

            'EXECUTA A CONSULTA SQL NO DATABASE USANDO O OBJETO E CRIA UM NOVO OBJETO DE LEITURA PARA LER O RESULTADO DA CONSULTA.'

            LISTVIEW1_PLAYER1.Items.Clear() 'LIMPA A LISTVIEW PARA RECEBER O RESULTADO DA CONSULTA.'

            While reader.Read() 'ENQUANTO O OBJETO DO LEITOR LÊ CADA LINHA DA TABELA TIME1 DENTRO DO RESULTADO DA CONSULTA.'

                Dim hp As Integer = Integer.Parse(reader("HP").ToString()) 'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'
                Dim mp As Integer = Integer.Parse(reader("MP").ToString()) 'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'
                Dim status As String = reader("PSTATUS").ToString()        'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'

                Dim item As New ListViewItem()   'CRIA UM NOVO ITEM PARA A LISTVIEW.'
                item.Text = hp.ToString()        'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM HP PARA STRING.'
                item.SubItems.Add(mp.ToString()) 'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM MP PARA STRING.'
                item.SubItems.Add(status)        'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM STATUS PARA STRING.'

                LISTVIEW1_PLAYER1.Items.Add(item) 'ADICIONA O ITEM À LISTVIEW1.'

            End While 'DEPOIS DE TODAS AS LINHAS LIDAS DA TAABELA O WHILE É FECHADO.'

            reader.Close()

            conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        Else 'DO CONTRÁRIO...'
            MessageBox.Show("Por favor, selecione um Pokémon na ComboBox.") 'EXIBE UMA MENSAGEM.'
        End If

        Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

        'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
        'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

        If selectedDataRowView IsNot Nothing Then

            Dim selectedPokemon As String = selectedDataRowView("NOME").ToString()

            'SE A VARIÁVEL NÃO FOR NULA ENTÃO...
            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            Dim query As String = "SELECT M.NOME AS MOVE
                               FROM Pokemon AS P
                               JOIN Moves AS M ON P.ID = M.Pokemon_ID
                               WHERE P.NOME = @Nome"                   'CRIA UMA STRING DE UMA CONSULTA SQL.'

            conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

            Dim cmd As New MySqlCommand(query, conn)              'A VARIÁVEL STRING É INSERIDA À CONSULTA.'
            cmd.Parameters.AddWithValue("@Nome", selectedPokemon) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'
            Dim reader As MySqlDataReader = cmd.ExecuteReader()   ''EXECUTA A CONSULTA SQL NO DATABASE USANDO O OBJETO E CRIA UM NOVO OBJETO DE LEITURA PARA LER O RESULTADO DA CONSULTA.'


            ATTACK1_PLAYER1.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'

            Dim moveCounter As Integer = 1 'INICIA UM CONTADOR COM VALOR 1.'

            While reader.Read() AndAlso moveCounter <= 4 'ENQUANTO O CONTADOR FOR MENOR E IGUAL A 4...

                'ESTE LOOP LÊ CADA LINHA DO RESULTADO DA CONSULTA'

                Dim moveName As String = reader("MOVE").ToString() 'EXTRAI O VALOR DO RESULTADO DA CONSULTA E O PASSA PARA STRING.'

                SetMoveButtonText(moveCounter, moveName) 'CHAMA A FUNÇÃO PARA DEFINIR O TEXTO DO BOTÃO DE ATAQUE CORRESPONDENTE.'

                moveCounter += 1 'INCREMENTA O CONTADOR.'

            End While 'TERMINA O CICLO APÓS O CONTADOR SER = 4.'

            reader.Close() 'FECHA O OBJETO.'

            conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        Else 'DO CONTRÁRIO...

            MessageBox.Show("Por favor, selecione um Pokémon na ComboBox.") 'EXIBE A MENSAGEM.'

        End If

        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then 'SE O POKEMON FOR O POKEMON SELECIONADO NA MINHA COMBOBOX...

            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

            'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
            'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            Dim POKETIPO As String = "SELECT TIPO FROM TIME1 WHERE NOME = @NomePokemon" 'CRIA UMA STRING DE CONSULTA SQL.'
            Dim POKELABEL As String = "SELECT NOME FROM TIME1 WHERE NOME = @NomePokemon" 'CRIA UMA STRING DE CONSULTA SQL.'

            Using cmd As New MySqlCommand(POKETIPO, conn) 'USA UMA VARIÁVEL JÁ USADA PARA FAZER A CONSULTA.'

                cmd.Parameters.AddWithValue("@NomePokemon", selectedPokemon1) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'

                conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                Dim TIPOKEMON As String = CStr(cmd.ExecuteScalar()) 'EXECUTA A CONSULTA E RETORNA O PRIMEIRO VALOR DA COLUNA.'

                conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                BUTTON_TYPE_PLAYER1.Text = TIPOKEMON 'ATUALIZA O TEXTO DA LABEL.'

            End Using 'FIM DO USO DA VARIÁVEL.'

            Using cmd As New MySqlCommand(POKELABEL, conn) 'USA UMA VARIÁVEL JÁ USADA PARA FAZER A CONSULTA.'

                cmd.Parameters.AddWithValue("@NomePokemon", selectedPokemon1) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'

                conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                Dim LABELPOKE As String = CStr(cmd.ExecuteScalar()) 'EXECUTA A CONSULTA E RETORNA O PRIMEIRO VALOR DA COLUNA.'

                conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                LABELNAME_P1.Text = LABELPOKE 'ATUALIZA O TEXTO DA LABEL.'

            End Using 'FIM DO USO DA VARIÁVEL.'

        End If

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

        AssociarImagemAoNome(LABELNAME_P1.Text) 'TEXTO DA LABEL RECEBE O NOME DO POKEMON ESCOLHIDO.'

        PictureBox1_PLAYER1.Show()

        If BUTTON_STARTBATTLE.Text = "BATTLE" Then
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            Return
        End If

        ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'

        ATTACK1_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER2.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'

        ATTACK1_PLAYER2.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER2.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER2.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER2.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'

        ATTACK1_PLAYER1.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER1.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER1.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER1.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'

    End Sub

    Private Sub BUTTON_ESCOLHER_POKEMON_P2_Click(sender As Object, e As EventArgs) Handles BUTTON_ESCOLHER_POKEMON_P2.Click

        BUTTON_STATUS_PLAYER2.Text = "NORMAL" 'QUANDO O SE ESCOLHE UM POKEMON, AUTOMATICAMENTE SEU STATUS PASSA PRA NORMAL.'

        'ESTE BOTÃO INSERE O POKEMON DENTRO DA COMBOBOX PRO LISTVIEW E DISTRIBUI OS SEUS MOVIMENTO ENTRE OS BOTÓES DE ATAQUE.'

        Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

        'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
        'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

        If selectedDataRowView IsNot Nothing Then

            Dim selectedPokemon As String = selectedDataRowView("NOME").ToString()

            'SE A VARIÁVEL NÃO FOR NULA ENTÃO...
            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            MessageBox.Show("Você selecionou: " & selectedPokemon) 'MENSAGEM PARA VERIFICAR SE ALGUM POKEMON FOI ESCOLHIDO.'

            Dim LISTVIEW2 As String = "SELECT HP, MP, PSTATUS FROM TIME2 WHERE NOME = @Nome" 'CRIA UMA STRING DE UMA CONSULTA SQL.'

            conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

            Dim cmd As New MySqlCommand(LISTVIEW2, conn) 'CRIA UM NOVO OBJETO ASSOCIADO À CONSULTA SQL.'

            cmd.Parameters.AddWithValue("@Nome", selectedPokemon)

            'ADICIONA O PARÂMETRO @NOME À CONSULTA SQL E ASSOCIA A ELE O VALOR DA VARIÁVEL.'
            'ISSO É FEITO PARA QUE O @NOME TENHA UMA REFERÊNCIA PARA A CONSULTA.'

            Dim reader As MySqlDataReader = cmd.ExecuteReader()

            'EXECUTA A CONSULTA SQL NO DATABASE USANDO O OBJETO E CRIA UM NOVO OBJETO DE LEITURA PARA LER O RESULTADO DA CONSULTA.'

            LISTVIEW2_PLAYER2.Items.Clear() 'LIMPA A LISTVIEW PARA RECEBER O RESULTADO DA CONSULTA.'

            While reader.Read() 'ENQUANTO O OBJETO DO LEITOR LÊ CADA LINHA DA TABELA TIME1 DENTRO DO RESULTADO DA CONSULTA.'

                Dim hp As Integer = Integer.Parse(reader("HP").ToString()) 'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'
                Dim mp As Integer = Integer.Parse(reader("MP").ToString()) 'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'
                Dim status As String = reader("PSTATUS").ToString()        'CRIA UMA VARIÁVEL E PASSA ELA PARA STRING.'

                Dim item As New ListViewItem()   'CRIA UM NOVO ITEM PARA A LISTVIEW.'
                item.Text = hp.ToString()        'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM HP PARA STRING.'
                item.SubItems.Add(mp.ToString()) 'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM MP PARA STRING.'
                item.SubItems.Add(status)        'DEFINE O TEXTO DO PRIMEIRO SUBITEM DO ITEM STATUS PARA STRING.'

                LISTVIEW2_PLAYER2.Items.Add(item) 'ADICIONA O ITEM À LISTVIEW1.'

            End While 'DEPOIS DE TODAS AS LINHAS LIDAS DA TAABELA O WHILE É FECHADO.'

            reader.Close() 'ENCERRA O LEITOR'

            conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

        Else 'DO CONTRÁRIO...'
            MessageBox.Show("Por favor, selecione um Pokémon na ComboBox.") 'EXIBE UMA MENSAGEM.'
        End If

        Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

        'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
        'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

        If selectedDataRowView IsNot Nothing Then
            Dim selectedPokemon As String = selectedDataRowView("NOME").ToString()

            'SE A VARIÁVEL NÃO FOR NULA ENTÃO...
            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            Dim query As String = "SELECT M.NOME AS MOVE
                               FROM Pokemon AS P
                               JOIN Moves AS M ON P.ID = M.Pokemon_ID
                               WHERE P.NOME = @Nome"                   'CRIA UMA STRING DE UMA CONSULTA SQL.'

            conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

            Dim cmd As New MySqlCommand(query, conn)              'A VARIÁVEL STRING É INSERIDA À CONSULTA.'
            cmd.Parameters.AddWithValue("@Nome", selectedPokemon) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'
            Dim reader As MySqlDataReader = cmd.ExecuteReader()   'EXECUTA A CONSULTA SQL NO DATABASE USANDO O OBJETO E CRIA UM NOVO OBJETO DE LEITURA PARA LER O RESULTADO DA CONSULTA.'


            ATTACK1_PLAYER2.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Text = "" 'LIMPA O BOTÃO DE ATAQUE.'

            Dim moveCounter As Integer = 1 'INICIA UM CONTADOR COM VALOR 1.'

            While reader.Read() AndAlso moveCounter <= 4 'ENQUANTO O CONTADOR FOR MENOR E IGUAL A 4...

                'ESTE LOOP LÊ CADA LINHA DO RESULTADO DA CONSULTA'

                Dim moveName As String = reader("MOVE").ToString() 'EXTRAI O VALOR DO RESULTADO DA CONSULTA E O PASSA PARA STRING.'

                SetMoveButtonText2(moveCounter, moveName) 'CHAMA A FUNÇÃO PARA DEFINIR O TEXTO DO BOTÃO DE ATAQUE CORRESPONDENTE.'

                moveCounter += 1 'INCREMENTA O CONTADOR.'

            End While 'TERMINA O CICLO APÓS O CONTADOR SER = 4.'

            reader.Close() 'FECHA O OBJETO.'

            conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQl.'

        Else 'DO CONTRÁRIO...

            MessageBox.Show("Por favor, selecione um Pokémon na ComboBox.") 'EXIBE A MENSAGEM.'

        End If

        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then 'SE O POKEMON FOR O POKEMON SELECIONADO NA MINHA COMBOBOX...

            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

            'CRIA UMA VARIÁVEL QUE ARMAZENA A LINHA DE DADOS SELECIONADA NA COMBOBOX...
            'ELA USA DO MÉTODO CTYPE PARA CONVERTER O ITEM SELECIONADO NA COMBOBOX EM UM OBJETO.'

            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

            'EXTRAI O VALOR DA COLUNA NOME "NOME" DA LINHA SELECIONADA NA COMBOBOX E O ARMAZENA NA VARIÁVEL COMO UMA STRING.'

            Dim POKETIPO As String = "SELECT TIPO FROM TIME2 WHERE NOME = @NomePokemon" 'CRIA UMA STRING DE CONSULTA SQL.'
            Dim POKELABEL As String = "SELECT NOME FROM TIME2 WHERE NOME = @NomePokemon" 'CRIA UMA STRING DE CONSULTA SQL.'

            Using cmd As New MySqlCommand(POKETIPO, conn) 'USA UMA VARIÁVEL JÁ USADA PARA FAZER A CONSULTA.'

                cmd.Parameters.AddWithValue("@NomePokemon", selectedPokemon1) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'

                conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                Dim TIPOKEMON As String = CStr(cmd.ExecuteScalar()) 'EXECUTA A CONSULTA E RETORNA O PRIMEIRO VALOR DA COLUNA.'

                conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                BUTTON_TYPE_PLAYER2.Text = TIPOKEMON 'ATUALIZA O TEXTO DA LABEL.'

            End Using 'FIM DO USO DA VARIÁVEL.'

            Using cmd As New MySqlCommand(POKELABEL, conn) 'USA UMA VARIÁVEL JÁ USADA PARA FAZER A CONSULTA.'

                cmd.Parameters.AddWithValue("@NomePokemon", selectedPokemon1) 'ADICIONA UM PARÂMETRO NOME À CONSULTA SQL PARA INSERIR 'NOME' ONDE HÁ @NOME.'

                conn.Open() 'COMANDO PARA ABRIR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                Dim LABELPOKE As String = CStr(cmd.ExecuteScalar()) 'EXECUTA A CONSULTA E RETORNA O PRIMEIRO VALOR DA COLUNA.'

                conn.Close() 'COMANDO PARA FECHAR UMA CONEXÃO COM O SERVIDOR MYSQL.'

                LABELNAME_P2.Text = LABELPOKE 'ATUALIZA O TEXTO DA LABEL.'

            End Using 'FIM DO USO DA VARIÁVEL.'

        End If

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

        AssociarImagemAoNome2(LABELNAME_P2.Text) 'TEXTO DA LABEL RECEBE O NOME DO POKEMON ESCOLHIDO.'

        PictureBox2_PLAYER2.Show()

        If BUTTON_STARTBATTLE.Text = "BATTLE" Then
            ATTACK1_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
            Return
        End If

        ATTACK1_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER1.Visible = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK1_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER2.Visible = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK1_PLAYER2.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER2.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER2.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER2.Enabled = False 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK1_PLAYER1.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER1.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER1.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER1.Enabled = True 'ESCONDER BOTÃO DE ATAQUE.'

    End Sub

    Public Sub BUTTON_STARTBATTLE_Click(sender As Object, e As EventArgs) Handles BUTTON_STARTBATTLE.Click

        If LISTVIEW1_PLAYER1.Items.Count = 0 OrElse LISTVIEW2_PLAYER2.Items.Count = 0 Then 'SE ALGUMA DAS LISTVIEWS ESTIVEREM VAZIAS...
            MessageBox.Show("O PLAYER1 E O PLAYER2 DEVEM SELECIONAR UM POKÉMON ANTES DE COMEÇAR.") 'EXIBE MENSAGEM.'
            Return 'RETORNA SEM EXECUTAR O RESTO DO CÓDIGO.'
        End If

        timer.Start() 'INICIA O TIMER.'
        Dim random As New Random() 'CRIA UMA VARIÁVEL RANDOM.'
        Dim hidebuttons As Double = random.NextDouble() 'A VARIÁVEL DOUBLE RECEBE A VARIÁVEL RANDOM.'

        If hidebuttons < 0.5 Then 'VARIÁVEL DECLARADA EM PUBLIC CLASS PARA GUARDAR UMA PROBABILIDADE RANDOM.'
            ATTACK1_PLAYER1.Visible = False 'ESCONDE O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = False 'ESCONDE O BOTÃO.'
            ATTACK3_PLAYER1.Visible = False 'ESCONDE O BOTÃO.'
            ATTACK4_PLAYER1.Visible = False 'ESCONDE O BOTÃO.'
            ATTACK1_PLAYER2.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
        Else
            ATTACK1_PLAYER1.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER1.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER1.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER1.Visible = True  'EXIBE O BOTÃO DE ATAQUE.'
            ATTACK1_PLAYER2.Visible = False 'ESCONDE O BOTÃO DE ATAQUE.'
            ATTACK2_PLAYER2.Visible = False 'ESCONDE O BOTÃO DE ATAQUE.'
            ATTACK3_PLAYER2.Visible = False 'ESCONDE O BOTÃO DE ATAQUE.'
            ATTACK4_PLAYER2.Visible = False 'ESCONDE O BOTÃO DE ATAQUE.'
        End If

        BUTTON_STARTBATTLE.Text = "LUTAR" 'O NOME DO BOTÃO MUDA PARA LUTAR.'

        BUTTON_STARTBATTLE.Enabled = False 'DESABILITA O BOTÃO DE START.'

        BUTTON_STARTBATTLE.Text = "-LUTAR-" 'O NOME DO BOTÃO MUDA PARA -LUTAR-.'

        ENABLEBUTTON() 'SUB CRIADA PARA GUARDAR O ESTADO DOS BOTÕES DE ESCOLHA.'

        ESCOLHERTIME_PLAYER1.Enabled = False 'BOTÃO DE TIME1 DESABILITADO.'
        ESCOLHERTIME_PLAYER2.Enabled = False 'BOTÃO DE TIME1 DESABILITADO.'

    End Sub

    'TODAS AS VEZES QUE UM BOTÃO DE ATAQUE É APERTADO, OS BOTÕES DE ATAQUE SOMEM PARA QUE O OUTRO PLAYER ATAQUE.'
    'ALGUNS STATUS E CONDIÇÕES TÊM DE SER DEFINIDOS AQUI PORQUE ALGUMAS TÉCNICAS NÃO CHAMAM A FUNÇÃO DE DANO PADRÃO.'

    Public Sub ATTACK1_PLAYER1_Click(sender As Object, e As EventArgs) Handles ATTACK1_PLAYER1.Click 'BOTÃO DE ATAQUE1.'

        ATTACK1_PLAYER1.Enabled = False 'ESCONDE O BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER1.Enabled = False 'ESCONDE O BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER1.Enabled = False 'ESCONDE O BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER1.Enabled = False 'ESCONDE O BOTÃO DE ATAQUE.'
        ATTACK1_PLAYER2.Enabled = True  'EXIBE O BOTÃO DE ATAQUE.'
        ATTACK2_PLAYER2.Enabled = True  'EXIBE O BOTÃO DE ATAQUE.'
        ATTACK3_PLAYER2.Enabled = True  'EXIBE O BOTÃO DE ATAQUE.'
        ATTACK4_PLAYER2.Enabled = True  'EXIBE O BOTÃO DE ATAQUE.'

        If BUTTON_STATUS_PLAYER1.Text = "ENCAPSULADO" Then

            Dim random As New Random()
            Dim chanceDeAcordar As Double = random.NextDouble()

            If chanceDeAcordar < 0.5 Then
                MessageBox.Show("O Pokémon consegue agora usar todas as suas técnicas")
                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                ATTACK1_PLAYER1.Visible = True
                ATTACK2_PLAYER1.Visible = True
                ATTACK3_PLAYER1.Visible = True
                ATTACK4_PLAYER1.Visible = True
            Else
                MessageBox.Show("O Pokémon continua encapsulado")
                ATTACK1_PLAYER1.Visible = True
                ATTACK2_PLAYER1.Visible = False
                ATTACK3_PLAYER1.Visible = False
                ATTACK4_PLAYER1.Visible = False
            End If
        End If

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER1.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER1.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        Dim buttonName As String = ATTACK1_PLAYER1.Text

        Select Case buttonName

            Case "Transform"

                ATTACK1_PLAYER1.Text = ATTACK1_PLAYER2.Text
                ATTACK2_PLAYER1.Text = ATTACK2_PLAYER2.Text
                ATTACK3_PLAYER1.Text = ATTACK3_PLAYER2.Text
                ATTACK4_PLAYER1.Text = ATTACK4_PLAYER2.Text

                BUTTON_TYPE_PLAYER1.Text = BUTTON_TYPE_PLAYER2.Text

                Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10

                        item2.SubItems(1).Text = mpValue.ToString()

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer1.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime1(selectedPokemon1)

                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                        LoadComboBoxData()

                    End If

                Next

            Case "Tackle"

                AplicarAtaqueNoPokemon2("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon2("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon2("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon2("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 20

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW2_PLAYER2.Items.Remove(item)

                            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime2(selectedPokemon2)
                                ComboBox2_TIMEPLAYER2.Refresh()
                                ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer1.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime1(selectedPokemon1)
                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon2("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon2("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon2("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon2("Absorb", 20, "Grama")

            Case "Bite"

                AplicarAtaqueNoPokemon2("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon2("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW1_PLAYER1.Items.Remove(item)
                LISTVIEW1_PLAYER1.Items.Clear()

                ExcluirPokemonDoTime1(selectedPokemon1)

                ComboBox1_TIMEPLAYER1.Refresh()
                ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                LoadComboBoxData()

                MessageBox.Show("Seu Pokemon fugiu da arena")

            Case "Splash"

                AplicarAtaqueNoPokemon2("Splash", 50, "Água")

            Case "Vine Whip"

                AplicarAtaqueNoPokemon2("Vine Whip", 45, "Grama")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon2("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon2("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon2("Lick", 20, "Fantasma")

            Case Else

        End Select

    End Sub

    Private Sub ATTACK2_PLAYER1_Click(sender As Object, e As EventArgs) Handles ATTACK2_PLAYER1.Click

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        ATTACK1_PLAYER1.Enabled = False
        ATTACK2_PLAYER1.Enabled = False
        ATTACK3_PLAYER1.Enabled = False
        ATTACK4_PLAYER1.Enabled = False
        ATTACK1_PLAYER2.Enabled = True
        ATTACK2_PLAYER2.Enabled = True
        ATTACK3_PLAYER2.Enabled = True
        ATTACK4_PLAYER2.Enabled = True

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER1.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER1.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        Dim buttonName As String = ATTACK2_PLAYER1.Text

        Select Case buttonName

            Case "Tackle"

                AplicarAtaqueNoPokemon2("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon2("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon2("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon2("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 40

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW2_PLAYER2.Items.Remove(item)

                            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime2(selectedPokemon2)
                                ComboBox2_TIMEPLAYER2.Refresh()
                                ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer1.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime1(selectedPokemon1)
                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon2("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon2("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon2("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon2("Absorb", 20, "Grama")

            Case "Bite"

                AplicarAtaqueNoPokemon2("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon2("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW1_PLAYER1.Items.Remove(item)
                LISTVIEW1_PLAYER1.Items.Clear()

                ExcluirPokemonDoTime1(selectedPokemon1)

                ComboBox1_TIMEPLAYER1.Refresh()
                ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                LoadComboBoxData()

            Case "Splash"

                AplicarAtaqueNoPokemon2("Splash", 50, "Água")

            Case "Vine Whip"

                AplicarAtaqueNoPokemon2("Vine Whip", 45, "Grama")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon2("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon2("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon2("Lick", 20, "Fantasma")

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player2 diminui.")

                                BUTTON_STATUS_PLAYER2.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tail Whip"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player2 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER2.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Shock"

                AplicarAtaqueNoPokemon2("Thunder Shock", 55, "Elétrico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Supersonic"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player2 está confuso."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER1.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Karate Chop"

                AplicarAtaqueNoPokemon2("Karate Chop", 50, "Lutador")

            Case "Conversion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then
                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET TIPO = @novotipo WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")
                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim rando1 As New Random()
                            Dim tiposElementos As String() = {"Água", "Fogo", "Grama", "Gelo", "Aço", "Fantasma", "Inseto", "Veneno", "Voador", "Dragão", "Pedra", "Terra", "Psíquico", "Lutador"}
                            Dim novoTipo As String = tiposElementos(random.Next(0, tiposElementos.Length))

                            BUTTON_TYPE_PLAYER1.Text = novoTipo

                            MessageBox.Show("O tipo de elemento do Pokémon foi alterado para " & novoTipo)

                            command.Parameters.AddWithValue("@novotipo", novoTipo)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using
                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Encore"

                ' A TÉCNICA INSERE O STATUS DE ENCAPSULAMENTO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "ENCAPSULADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "ENCAPSULADO" Then
                                    mensagem = "O Pokémon do Player2 só pode usar uma habilidade."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = False
                                    ATTACK3_PLAYER2.Visible = False
                                    ATTACK4_PLAYER2.Visible = False
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = True
                                    ATTACK3_PLAYER2.Visible = True
                                    ATTACK4_PLAYER2.Visible = True
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sweet Scent"

                'A TÉCNICA INSERE O STATUS DE SEDUÇÃO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.4, "SEDUZIDO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "SEDUZIDO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "SEDUZIDO"
                                    mensagem = "O Pokémon do Player2 foi seduzido."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                ' A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.
                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then
                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")
                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            ' Verifique se o Pokémon do Player2 é do tipo Grama
                            If BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                MessageBox.Show("O Pokémon do Player2 é imune a esta técnica.")
                            Else
                                Dim chance As Double = random.NextDouble()
                                Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                                command.Parameters.AddWithValue("@novoStatus", novoStatus)
                                command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                                Dim rowsAffected As Integer = command.ExecuteNonQuery()
                                Dim mensagem As String = ""

                                If rowsAffected > 0 Then
                                    If novoStatus = "PARALISADO" Then
                                        BUTTON_STATUS_PLAYER2.Text = "PARALISADO"
                                        mensagem = "O Pokémon do Player2 foi paralisado."
                                    Else
                                        mensagem = "A técnica não surtiu efeito."
                                        BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    End If
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                End If

                                MessageBox.Show(mensagem)
                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()
                            End If
                        End Using
                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Disable"

                ' A TÉCNICA INSERE O STATUS DE DESABILITADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "DESABILITADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""
                            Dim numeroAleatorio As Integer = random.Next(1, 5)

                            If rowsAffected > 0 Then
                                If novoStatus = "DESABILITADO" Then
                                    mensagem = "Uma habilidade foi desabilitada."
                                    numeroAleatorio = New Random().Next(1, 5) ' Gera um novo valor aleatório
                                    configuracaoBotao = numeroAleatorio ' Armazena a configuração do botão

                                    Select Case configuracaoBotao
                                        Case 1
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = False
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 2
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = False
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 3
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = False
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 4
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = False
                                    End Select
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                End If
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Wrap"

                AplicarAtaqueNoPokemon2("Wrap", 15, "Normal")

            Case "Gust"

                AplicarAtaqueNoPokemon2("Gust", 40, "Voador")

            Case "Sand Attack"

                'A TÉCNICA INSERE O STATUS DE CEGUEIRA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CEGO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "CEGO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "CEGO"
                                    mensagem = "O Pokémon do Player2 está cego."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case Else

        End Select


    End Sub

    Private Sub ATTACK3_PLAYER1_Click(sender As Object, e As EventArgs) Handles ATTACK3_PLAYER1.Click

        ATTACK1_PLAYER1.Enabled = False
        ATTACK2_PLAYER1.Enabled = False
        ATTACK3_PLAYER1.Enabled = False
        ATTACK4_PLAYER1.Enabled = False
        ATTACK1_PLAYER2.Enabled = True
        ATTACK2_PLAYER2.Enabled = True
        ATTACK3_PLAYER2.Enabled = True
        ATTACK4_PLAYER2.Enabled = True

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER1.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER1.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        Dim buttonName As String = ATTACK3_PLAYER1.Text

        Select Case buttonName

            Case "Poison Powder"

                'A TÉCNICA INSERE O STATUS DE ENVENENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "ENVENENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Veneno" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Veneno" Then
                                If novoStatus = "ENVENENADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "ENVENENADO"
                                    mensagem = "O Pokémon foi envenenado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tackle"

                AplicarAtaqueNoPokemon2("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon2("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon2("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon2("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 40

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW2_PLAYER2.Items.Remove(item)

                            If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime2(selectedPokemon2)
                                ComboBox2_TIMEPLAYER2.Refresh()
                                ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer1.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime1(selectedPokemon1)
                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon2("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon2("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon2("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon2("Absorb", 20, "Grama")

            Case "Bite"

                AplicarAtaqueNoPokemon2("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon2("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW1_PLAYER1.Items.Remove(item)
                LISTVIEW1_PLAYER1.Items.Clear()

                ExcluirPokemonDoTime1(selectedPokemon1)

                ComboBox1_TIMEPLAYER1.Refresh()
                ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                LoadComboBoxData()

            Case "Splash"

                AplicarAtaqueNoPokemon2("Splash", 50, "Água")

            Case "Vine Whip"

                AplicarAtaqueNoPokemon2("Vine Whip", 45, "Grama")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon2("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon2("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon2("Lick", 20, "Voador")

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player2 diminui.")

                                BUTTON_STATUS_PLAYER2.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tail Whip"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player2 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER2.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Shock"

                AplicarAtaqueNoPokemon2("Thunder Shock", 55, "Elétrico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Supersonic"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player2 está confuso."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER1.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Karate Chop"

                AplicarAtaqueNoPokemon2("Karate Chop", 50, "Lutador")

            Case "Conversion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then
                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET TIPO = @novotipo WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")
                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim rando1 As New Random()

                            ' Lista de tipos de elementos possíveis'
                            Dim tiposElementos As String() = {"Água", "Fogo", "Grama", "Gelo", "Aço", "Fantasma", "Inseto", "Veneno", "Voador", "Dragão", "Pedra", "Terra", "Psíquico", "Lutador"}

                            ' Sorteia um tipo de elemento aleatoriamente'
                            Dim novoTipo As String = tiposElementos(random.Next(0, tiposElementos.Length))

                            BUTTON_TYPE_PLAYER1.Text = novoTipo

                            MessageBox.Show("O tipo de elemento do Pokémon foi alterado para " & novoTipo)

                            command.Parameters.AddWithValue("@novotipo", novoTipo)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using
                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Encore"

                ' A TÉCNICA INSERE O STATUS DE ENCAPSULAMENTO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "ENCAPSULADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "ENCAPSULADO" Then

                                    mensagem = "O Pokémon do Player2 só pode usar uma habilidade."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sweet Scent"

                'A TÉCNICA INSERE O STATUS DE SEDUÇÃO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.4, "SEDUZIDO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "SEDUZIDO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "SEDUZIDO"
                                    mensagem = "O Pokémon do Player2 foi seduzido."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                ElseIf BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Disable"

                ' A TÉCNICA INSERE O STATUS DE DESABILITADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "DESABILITADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""
                            Dim numeroAleatorio As Integer = random.Next(1, 5)

                            If rowsAffected > 0 Then
                                If novoStatus = "DESABILITADO" Then
                                    mensagem = "Uma habilidade foi desabilitada."
                                    numeroAleatorio = New Random().Next(1, 5) ' Gera um novo valor aleatório
                                    configuracaoBotao = numeroAleatorio ' Armazena a configuração do botão

                                    Select Case configuracaoBotao
                                        Case 1
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = False
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 2
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = False
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 3
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = False
                                            ATTACK4_PLAYER2.Visible = True
                                        Case 4
                                            BUTTON_STATUS_PLAYER2.Text = novoStatus
                                            ATTACK1_PLAYER2.Visible = True
                                            ATTACK2_PLAYER2.Visible = True
                                            ATTACK3_PLAYER2.Visible = True
                                            ATTACK4_PLAYER2.Visible = False
                                    End Select
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                End If
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Wrap"

                AplicarAtaqueNoPokemon2("Wrap", 15, "Normal")

            Case "Gust"

                AplicarAtaqueNoPokemon2("Gust", 40, "Voador")

            Case "Leech Seed"

                'A TÉCNICA INSERE O STATUS DE DRENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "DRENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Grama" Then
                                If novoStatus = "DRENADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "DRENADO"
                                    mensagem = "A semente foi plantada."
                                ElseIf BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Leer"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player2 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER2.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Transform"

                ATTACK1_PLAYER1.Text = ATTACK1_PLAYER2.Text
                ATTACK2_PLAYER1.Text = ATTACK2_PLAYER2.Text
                ATTACK3_PLAYER1.Text = ATTACK3_PLAYER2.Text
                ATTACK4_PLAYER1.Text = ATTACK4_PLAYER2.Text

                BUTTON_TYPE_PLAYER1.Text = BUTTON_TYPE_PLAYER2.Text

                Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10

                        item2.SubItems(1).Text = mpValue.ToString()

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer1.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                    LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                    If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime1(selectedPokemon1)

                        ComboBox1_TIMEPLAYER1.Refresh()
                        ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                        LoadComboBoxData()

                    End If

                Next

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player2 diminui.")

                                BUTTON_STATUS_PLAYER2.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sharpen"

                'A TÉCNICA INSERE O STATUS AFIADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "AFIADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon afia suas garras.")

                                BUTTON_STATUS_PLAYER1.Text = "AFIADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Roar"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player2 diminui.")

                                BUTTON_STATUS_PLAYER2.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Bite"

                AplicarAtaqueNoPokemon2("Bite", 60, "Normal")

            Case "Water Gun"

                AplicarAtaqueNoPokemon2("Water Gun", 40, "Água")

            Case "Ember"

                AplicarAtaqueNoPokemon2("Ember", 40, "Fogo")

            Case "Double Slap"

                AplicarAtaqueNoPokemon2("Double Slap", 15, "Normal")

            Case "Flail"

                AplicarAtaqueNoPokemon2("Flail", 50, "Normal")

            Case "Wrap"

                AplicarAtaqueNoPokemon2("Wrap", 50, "Normal")

            Case "Sand Attack"

                'A TÉCNICA INSERE O STATUS DE CEGUEIRA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CEGO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "CEGO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "CEGO"
                                    mensagem = "O Pokémon do Player2 está cego."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Quick Attack"

                AplicarAtaqueNoPokemon2("Quick Attack", 40, "Normal")

            Case "Dream Eater"

                AplicarAtaqueNoPokemon2("Dream Eater", 40, "Psíquico")

            Case "Double Team"

                'A TÉCNICA AUMENTA OS STATUS DE VELOCIDADE DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "VELOZ"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua velocidade.")

                                BUTTON_STATUS_PLAYER1.Text = "VELOZ"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Seismic Toss"

                AplicarAtaqueNoPokemon2("Seismic Toss", 70, "Lutador")

            Case Else

        End Select

    End Sub

    Private Sub ATTACK4_PLAYER1_Click(sender As Object, e As EventArgs) Handles ATTACK4_PLAYER1.Click

        ATTACK1_PLAYER1.Enabled = False
        ATTACK2_PLAYER1.Enabled = False
        ATTACK3_PLAYER1.Enabled = False
        ATTACK4_PLAYER1.Enabled = False
        ATTACK1_PLAYER2.Enabled = True
        ATTACK2_PLAYER2.Enabled = True
        ATTACK3_PLAYER2.Enabled = True
        ATTACK4_PLAYER2.Enabled = True

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER1.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER1.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW1_PLAYER1.Items.Remove(item)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon2)
                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        Dim buttonName As String = ATTACK4_PLAYER1.Text

        Select Case buttonName

            Case "Vine Whip"

                AplicarAtaqueNoPokemon2("Vine Whip", 45, "Grama")

            Case "Leer"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player2 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER2.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Withdraw"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER1.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Wave"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                End If


            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER1.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Confuse Ray"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player2 está confuso."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Rock Throw"

                AplicarAtaqueNoPokemon2("Rock Throw", 45, "Pedra")

            Case "Seismic Toss "

                AplicarAtaqueNoPokemon2("Seismic Toss", 70, "Lutador")

            Case "Foresight"

            Case "Struggle"

                AplicarAtaqueNoPokemon2("Struggle", 50, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon2("Quick Attack", 40, "Normal")

            Case "Psybeam"

                AplicarAtaqueNoPokemon2("Psybeam", 40, "Psíquico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                ElseIf BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Poison Powder"

                'A TÉCNICA INSERE O STATUS DE ENVENENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "ENVENENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Veneno" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Veneno" Then
                                If novoStatus = "ENVENENADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "ENVENENADO"
                                    mensagem = "O Pokémon foi envenenado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Leech Seed"

                'A TÉCNICA INSERE O STATUS DE DRENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "DRENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER2.Text <> "Grama" Then
                                If novoStatus = "DRENADO" Then
                                    BUTTON_STATUS_PLAYER2.Text = "DRENADO"
                                    mensagem = "A semente foi plantada."
                                ElseIf BUTTON_TYPE_PLAYER2.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Confusion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player2 está confuso."
                                    BUTTON_STATUS_PLAYER2.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer1 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW1_PLAYER1.Items

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer1.Add(item2)

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer1

                        LISTVIEW1_PLAYER1.Items.Remove(itemToRemove)

                        If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime1(selectedPokemon1)

                            ComboBox1_TIMEPLAYER1.Refresh()
                            ComboBox1_TIMEPLAYER1.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Pay Day"

                AplicarAtaqueNoPokemon2("Pay Day", 40, "Normal")

            Case "Karate Chop"

                AplicarAtaqueNoPokemon2("Karate Chop", 50, "Lutador")

            Case "Double Slap"

                AplicarAtaqueNoPokemon2("Double Slap", 15, "Normal")

            Case "Bounce"

                AplicarAtaqueNoPokemon2("Bounce", 85, "Normal")

            Case "Water Gun"

                AplicarAtaqueNoPokemon2("Water Gun", 40, "Água")

            Case "Fury Attack"

                AplicarAtaqueNoPokemon2("Fury Attack", 40, "Normal")

            Case "Rage"

                AplicarAtaqueNoPokemon2("Fury Attack", 20, "Rage")

            Case "Night Shade"

                AplicarAtaqueNoPokemon2("Night Shade", 30, "Fantasma")

            Case Else

        End Select

    End Sub

    Private Sub ATTACK1_PLAYER2_Click(sender As Object, e As EventArgs) Handles ATTACK1_PLAYER2.Click

        ATTACK1_PLAYER1.Enabled = True
        ATTACK2_PLAYER1.Enabled = True
        ATTACK3_PLAYER1.Enabled = True
        ATTACK4_PLAYER1.Enabled = True
        ATTACK1_PLAYER2.Enabled = False
        ATTACK2_PLAYER2.Enabled = False
        ATTACK3_PLAYER2.Enabled = False
        ATTACK4_PLAYER2.Enabled = False

        'PARA TENTAR SAIR DO ENCAPSULAMENTO.'

        If BUTTON_STATUS_PLAYER2.Text = "ENCAPSULADO" Then

            Dim random As New Random()
            Dim chanceDeAcordar As Double = random.NextDouble()

            If chanceDeAcordar < 0.5 Then
                MessageBox.Show("O Pokémon consegue agora usar todas as suas técnicas")
                BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                ATTACK1_PLAYER2.Visible = True
                ATTACK2_PLAYER2.Visible = True
                ATTACK3_PLAYER2.Visible = True
                ATTACK4_PLAYER2.Visible = True
            Else
                MessageBox.Show("O Pokémon continua encapsulado")
                ATTACK1_PLAYER2.Visible = True
                ATTACK2_PLAYER2.Visible = False
                ATTACK3_PLAYER2.Visible = False
                ATTACK4_PLAYER2.Visible = False
            End If
        End If

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER2.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER2.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        Dim buttonName As String = ATTACK1_PLAYER2.Text

        Select Case buttonName

            Case "Transform"

                ATTACK1_PLAYER2.Text = ATTACK1_PLAYER1.Text
                ATTACK2_PLAYER2.Text = ATTACK2_PLAYER1.Text
                ATTACK3_PLAYER2.Text = ATTACK3_PLAYER1.Text
                ATTACK4_PLAYER2.Text = ATTACK4_PLAYER1.Text

                BUTTON_TYPE_PLAYER2.Text = BUTTON_TYPE_PLAYER1.Text

                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                    If item2.SubItems.Count >= 2 Then

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer2.Add(item2)

                            End If

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime2(selectedPokemon1)

                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                        LoadComboBoxData()

                    End If

                Next

            Case "Tackle"

                AplicarAtaqueNoPokemon1("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon1("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon1("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon1("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 10

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW1_PLAYER1.Items.Remove(item)

                            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime1(selectedPokemon2)
                                ComboBox1_TIMEPLAYER1.Refresh()
                                ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer2.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime2(selectedPokemon1)
                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon1("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon1("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon1("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon1("Absorb", 20, "Planta")

            Case "Bite"

                AplicarAtaqueNoPokemon1("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon1("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW2_PLAYER2.Items.Remove(item)
                LISTVIEW2_PLAYER2.Items.Clear()

                ExcluirPokemonDoTime2(selectedPokemon1)

                ComboBox2_TIMEPLAYER2.Refresh()
                ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                LoadComboBoxData()

                MessageBox.Show("Seu Pokemon fugiu da arena")

            Case "Splash"

                AplicarAtaqueNoPokemon1("Splash", 50, "Água")

            Case "Vine Whip"

                AplicarAtaqueNoPokemon1("Vine Whip", 45, "Planta")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon1("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon1("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon1("Lick", 20, "Fantasma")

            Case Else

        End Select

    End Sub

    Private Sub ATTACK2_PLAYER2_Click(sender As Object, e As EventArgs) Handles ATTACK2_PLAYER2.Click

        ATTACK1_PLAYER1.Enabled = True
        ATTACK2_PLAYER1.Enabled = True
        ATTACK3_PLAYER1.Enabled = True
        ATTACK4_PLAYER1.Enabled = True
        ATTACK1_PLAYER2.Enabled = False
        ATTACK2_PLAYER2.Enabled = False
        ATTACK3_PLAYER2.Enabled = False
        ATTACK4_PLAYER2.Enabled = False

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER2.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER2.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        Dim buttonName As String = ATTACK2_PLAYER2.Text

        Select Case buttonName

            Case "Tackle"

                AplicarAtaqueNoPokemon1("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon1("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon1("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon1("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 40

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW1_PLAYER1.Items.Remove(item)

                            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime1(selectedPokemon2)
                                ComboBox1_TIMEPLAYER1.Refresh()
                                ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer2.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime2(selectedPokemon1)
                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon1("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon1("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon1("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon1("Absorb", 20, "Grama")

            Case "Bite"

                AplicarAtaqueNoPokemon1("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon1("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW2_PLAYER2.Items.Remove(item)
                LISTVIEW2_PLAYER2.Items.Clear()

                ExcluirPokemonDoTime2(selectedPokemon1)

                ComboBox2_TIMEPLAYER2.Refresh()
                ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                LoadComboBoxData()

                MessageBox.Show("Seu Pokemon fugiu da arena")

            Case "Splash"

                AplicarAtaqueNoPokemon1("Splash", 50, "Água")

            Case "Vine Whip"

                AplicarAtaqueNoPokemon1("Vine Whip", 45, "Grama")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon1("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon1("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon1("Lick", 20, "Fantasma")

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player1 diminui.")

                                BUTTON_STATUS_PLAYER1.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tail Whip"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player1 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER1.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Shock"

                AplicarAtaqueNoPokemon1("Thunder Shock", 55, "Elétrico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Supersonic"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player1 está confuso."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER2.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Karate Chop"

                AplicarAtaqueNoPokemon1("Karate Chop", 50, "Lutador")

            Case "Conversion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then
                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET TIPO = @novotipo WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")
                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim rando1 As New Random()

                            ' Lista de tipos de elementos possíveis'
                            Dim tiposElementos As String() = {"Água", "Fogo", "Grama", "Gelo", "Aço", "Fantasma", "Inseto", "Veneno", "Voador", "Dragão", "Pedra", "Terra", "Psíquico", "Lutador"}

                            ' Sorteia um tipo de elemento aleatoriamente'
                            Dim novoTipo As String = tiposElementos(random.Next(0, tiposElementos.Length))

                            BUTTON_TYPE_PLAYER2.Text = novoTipo

                            MessageBox.Show("O tipo de elemento do Pokémon foi alterado para " & novoTipo)

                            command.Parameters.AddWithValue("@novotipo", novoTipo)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using
                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Encore"

                ' A TÉCNICA INSERE O STATUS DE ENCAPSULAMENTO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "ENCAPSULADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "ENCAPSULADO" Then
                                    mensagem = "O Pokémon do Player1 só pode usar uma habilidade."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = False
                                    ATTACK3_PLAYER2.Visible = False
                                    ATTACK4_PLAYER2.Visible = False
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = True
                                    ATTACK3_PLAYER2.Visible = True
                                    ATTACK4_PLAYER2.Visible = True
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sweet Scent"

                'A TÉCNICA INSERE O STATUS DE SEDUÇÃO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.4, "SEDUZIDO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "SEDUZIDO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "SEDUZIDO"
                                    mensagem = "O Pokémon do Player1 foi seduzido."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                ElseIf BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Disable"

                ' A TÉCNICA INSERE O STATUS DE DESABILITADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "DESABILITADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""
                            Dim numeroAleatorio As Integer = random.Next(1, 5)

                            If rowsAffected > 0 Then
                                If novoStatus = "DESABILITADO" Then
                                    mensagem = "Uma habilidade foi desabilitada."
                                    numeroAleatorio = New Random().Next(1, 5) ' Gera um novo valor aleatório
                                    configuracaoBotao = numeroAleatorio ' Armazena a configuração do botão

                                    Select Case configuracaoBotao
                                        Case 1
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = False
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 2
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = False
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 3
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = False
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 4
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = False
                                    End Select
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                End If
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Wrap"

                AplicarAtaqueNoPokemon1("Wrap", 15, "Normal")

            Case "Gust"

                AplicarAtaqueNoPokemon1("Gust", 40, "Voador")

            Case "Sand Attack"

                'A TÉCNICA INSERE O STATUS DE CEGUEIRA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CEGO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "CEGO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "CEGO"
                                    mensagem = "O Pokémon do Player2 está cego."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case Else

        End Select

    End Sub

    Private Sub ATTACK3_PLAYER2_Click(sender As Object, e As EventArgs) Handles ATTACK3_PLAYER2.Click

        ATTACK1_PLAYER1.Enabled = True
        ATTACK2_PLAYER1.Enabled = True
        ATTACK3_PLAYER1.Enabled = True
        ATTACK4_PLAYER1.Enabled = True
        ATTACK1_PLAYER2.Enabled = False
        ATTACK2_PLAYER2.Enabled = False
        ATTACK3_PLAYER2.Enabled = False
        ATTACK4_PLAYER2.Enabled = False

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER2.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER2.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        Dim buttonName As String = ATTACK3_PLAYER2.Text

        Select Case buttonName

            Case "Poison Powder"

                'A TÉCNICA INSERE O STATUS DE ENVENENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "ENVENENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Veneno" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Veneno" Then
                                If novoStatus = "ENVENENADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "ENVENENADO"
                                    mensagem = "O Pokémon foi envenenado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tackle"

                AplicarAtaqueNoPokemon1("Tackle", 40, "Normal")

            Case "Scratch"

                AplicarAtaqueNoPokemon1("Scratch", 40, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon1("Quick Attack", 40, "Normal")

            Case "Pound"

                AplicarAtaqueNoPokemon1("Pound", 40, "Normal")

            Case "Leech Life"

                'ESTA TÉCNICA REPLICA O QUE É FEITO NA FUNÇÃO AplicarAtaqueNoPokemon2.'
                'COM UM INCREMENTO DE QUE 15% DO DANO INFLIGIDO RETORNE AO POKEMON.'

                Dim attackName As String = "Leech Life"
                Dim damage As Integer = 40

                MessageBox.Show("Dano do ataque " & attackName & ": " & damage.ToString())

                For Each item As ListViewItem In LISTVIEW1_PLAYER1.Items

                    Dim hpValue As Integer

                    If Integer.TryParse(item.Text, hpValue) Then

                        Dim pokemonType As String = BUTTON_TYPE_PLAYER1.Text
                        Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                        Dim calculatedDamage As Integer = resultadoDano.damage
                        Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                        If superEfetivo Then

                            MessageBox.Show("SUPER EFETIVO!")

                        End If

                        'AQUI ESTÁ A ALTERAÇÃO.'

                        hpValue -= calculatedDamage

                        Dim aumentoHP As Integer = CInt(0.15 * damage)

                        hpValue += aumentoHP

                        item.Text = hpValue.ToString()

                        If hpValue <= 0 Then

                            LISTVIEW1_PLAYER1.Items.Remove(item)

                            If ComboBox1_TIMEPLAYER1.SelectedIndex <> -1 Then

                                Dim selectedDataRowView2 As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)
                                Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                                ExcluirPokemonDoTime1(selectedPokemon2)
                                ComboBox1_TIMEPLAYER1.Refresh()
                                ComboBox1_TIMEPLAYER1.SelectedIndex = -1
                                LoadComboBoxData()

                            End If

                        End If

                        Exit For

                    End If

                Next

                'AQUI ESTÁ A ALTERAÇÃO.'

                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                    Dim mpValue As Integer

                    If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                        mpValue -= 10
                        item2.SubItems(1).Text = mpValue.ToString()

                        Dim hpValue As Integer

                        If Integer.TryParse(item2.SubItems(0).Text, hpValue) Then

                            Dim aumentoHP As Integer = CInt(0.15 * damage)

                            hpValue += aumentoHP

                            item2.SubItems(0).Text = hpValue.ToString()

                        End If

                        If mpValue <= 0 Then

                            pokemonToRemovePlayer2.Add(item2)

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime2(selectedPokemon1)
                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                        LoadComboBoxData()

                    End If
                Next

            Case "Low Kick"

                AplicarAtaqueNoPokemon1("Low Kick", 50, "Lutador")

            Case "Struggle"

                AplicarAtaqueNoPokemon1("Struggle", 50, "Normal")

            Case "Ember"

                AplicarAtaqueNoPokemon1("Ember", 40, "Fogo")

            Case "Absorb"

                AplicarAtaqueNoPokemon1("Absorb", 20, "Grama")

            Case "Bite"

                AplicarAtaqueNoPokemon1("Bite", 60, "Normal")

            Case "Bubble"

                AplicarAtaqueNoPokemon1("Bubble", 40, "Água")

            Case "Teleport"

                Dim item As ListViewItem

                Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                LISTVIEW2_PLAYER2.Items.Remove(item)
                LISTVIEW2_PLAYER2.Items.Clear()

                ExcluirPokemonDoTime2(selectedPokemon1)

                ComboBox2_TIMEPLAYER2.Refresh()
                ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                LoadComboBoxData()

                MessageBox.Show("Seu Pokemon fugiu da arena")

            Case "Splash"

                AplicarAtaqueNoPokemon1("Splash", 50, "Água")


            Case "Vine Whip"

                AplicarAtaqueNoPokemon1("Vine Whip", 45, "Grama")

            Case "Poison Sting"

                AplicarAtaqueNoPokemon1("Poison Sting", 15, "Veneno")

            Case "Peck"

                AplicarAtaqueNoPokemon1("Peck", 35, "Voador")

            Case "Lick"

                AplicarAtaqueNoPokemon1("Lick", 20, "Voador")

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player1 diminui.")

                                BUTTON_STATUS_PLAYER1.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Tail Whip"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player1 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER1.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Shock"

                AplicarAtaqueNoPokemon1("Thunder Shock", 55, "Elétrico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Supersonic"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player1 está confuso."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER2.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Karate Chop"

                AplicarAtaqueNoPokemon1("Karate Chop", 50, "Lutador")

            Case "Conversion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then
                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET TIPO = @novotipo WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")
                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim rando1 As New Random()

                            ' Lista de tipos de elementos possíveis'
                            Dim tiposElementos As String() = {"Água", "Fogo", "Grama", "Gelo", "Aço", "Fantasma", "Inseto", "Veneno", "Voador", "Dragão", "Pedra", "Terra", "Psíquico", "Lutador"}

                            ' Sorteia um tipo de elemento aleatoriamente'
                            Dim novoTipo As String = tiposElementos(random.Next(0, tiposElementos.Length))

                            BUTTON_TYPE_PLAYER2.Text = novoTipo

                            MessageBox.Show("O tipo de elemento do Pokémon foi alterado para " & novoTipo)

                            command.Parameters.AddWithValue("@novotipo", novoTipo)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using
                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Encore"

                ' A TÉCNICA INSERE O STATUS DE ENCAPSULAMENTO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "ENCAPSULADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "ENCAPSULADO" Then
                                    mensagem = "O Pokémon do Player1 só pode usar uma habilidade."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = False
                                    ATTACK3_PLAYER2.Visible = False
                                    ATTACK4_PLAYER2.Visible = False
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    ATTACK1_PLAYER2.Visible = True
                                    ATTACK2_PLAYER2.Visible = True
                                    ATTACK3_PLAYER2.Visible = True
                                    ATTACK4_PLAYER2.Visible = True
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sweet Scent"

                'A TÉCNICA INSERE O STATUS DE SEDUÇÃO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.4, "SEDUZIDO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "SEDUZIDO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "SEDUZIDO"
                                    mensagem = "O Pokémon do Player1 foi seduzido."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER2.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                ElseIf BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Disable"

                ' A TÉCNICA INSERE O STATUS DE DESABILITADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "DESABILITADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""
                            Dim numeroAleatorio As Integer = random.Next(1, 5)

                            If rowsAffected > 0 Then
                                If novoStatus = "DESABILITADO" Then
                                    mensagem = "Uma habilidade foi desabilitada."
                                    numeroAleatorio = New Random().Next(1, 5) ' Gera um novo valor aleatório
                                    configuracaoBotao = numeroAleatorio ' Armazena a configuração do botão

                                    Select Case configuracaoBotao
                                        Case 1
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = False
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 2
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = False
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 3
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = False
                                            ATTACK4_PLAYER1.Visible = True
                                        Case 4
                                            BUTTON_STATUS_PLAYER1.Text = novoStatus
                                            ATTACK1_PLAYER1.Visible = True
                                            ATTACK2_PLAYER1.Visible = True
                                            ATTACK3_PLAYER1.Visible = True
                                            ATTACK4_PLAYER1.Visible = False
                                    End Select
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                End If
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Wrap"

                AplicarAtaqueNoPokemon1("Wrap", 15, "Normal")

            Case "Gust"

                AplicarAtaqueNoPokemon1("Gust", 40, "Voador")

            Case "Leech Seed"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "DRENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Grama" Then
                                If novoStatus = "DRENADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "DRENADO"
                                    mensagem = "A semente foi plantada."
                                ElseIf BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Leer"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player1 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER1.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER2.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Transform"

                ATTACK1_PLAYER2.Text = ATTACK1_PLAYER1.Text
                ATTACK2_PLAYER2.Text = ATTACK2_PLAYER1.Text
                ATTACK3_PLAYER2.Text = ATTACK3_PLAYER1.Text
                ATTACK4_PLAYER2.Text = ATTACK4_PLAYER1.Text

                BUTTON_TYPE_PLAYER2.Text = BUTTON_TYPE_PLAYER1.Text

                Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                    If item2.SubItems.Count >= 2 Then

                        Dim mpValue As Integer

                        If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                            mpValue -= 10

                            item2.SubItems(1).Text = mpValue.ToString()

                            If mpValue <= 0 Then

                                pokemonToRemovePlayer2.Add(item2)

                            End If

                        End If

                    End If

                Next

                For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                    LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                    If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                        Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                        Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                        ExcluirPokemonDoTime2(selectedPokemon1)

                        ComboBox2_TIMEPLAYER2.Refresh()
                        ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                        LoadComboBoxData()

                    End If

                Next

            Case "Growl"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player1 diminui.")

                                BUTTON_STATUS_PLAYER1.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Sharpen"

                'A TÉCNICA INSERE O STATUS AFIADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "AFIADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon afia suas garras.")

                                BUTTON_STATUS_PLAYER2.Text = "AFIADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Roar"

                'A TÉCNICA INSERE O STATUS MEDO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "MEDO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O rosnado intimida o Pokémon e o ataque do Player1 diminui.")

                                BUTTON_STATUS_PLAYER1.Text = "MEDO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Bite"

                AplicarAtaqueNoPokemon1("Bite", 60, "Normal")

            Case "Water Gun"

                AplicarAtaqueNoPokemon1("Water Gun", 40, "Água")

            Case "Ember"

                AplicarAtaqueNoPokemon1("Ember", 40, "Fogo")

            Case "Double Slap"

                AplicarAtaqueNoPokemon1("Double Slap", 15, "Normal")

            Case "Flail"

                AplicarAtaqueNoPokemon1("Flail", 50, "Normal")

            Case "Wrap"

                AplicarAtaqueNoPokemon1("Wrap", 50, "Normal")

            Case "Sand Attack"

                'A TÉCNICA INSERE O STATUS DE CEGUEIRA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CEGO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then
                                If novoStatus = "CEGO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "CEGO"
                                    mensagem = "O Pokémon do Player2 está cego."

                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Quick Attack"

                AplicarAtaqueNoPokemon1("Quick Attack", 40, "Normal")

            Case "Dream Eater"

                AplicarAtaqueNoPokemon1("Dream Eater", 40, "Psíquico")

            Case "Double Team"

                'A TÉCNICA AUMENTA OS STATUS DE VELOCIDADE DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "VELOZ"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua velocidade.")

                                BUTTON_STATUS_PLAYER2.Text = "VELOZ"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Seismic Toss"

                AplicarAtaqueNoPokemon1("Seismic Toss", 70, "Lutador")

            Case Else

        End Select

    End Sub

    Private Sub ATTACK4_PLAYER2_Click(sender As Object, e As EventArgs) Handles ATTACK4_PLAYER2.Click

        ATTACK1_PLAYER1.Enabled = True
        ATTACK2_PLAYER1.Enabled = True
        ATTACK3_PLAYER1.Enabled = True
        ATTACK4_PLAYER1.Enabled = True
        ATTACK1_PLAYER2.Enabled = False
        ATTACK2_PLAYER2.Enabled = False
        ATTACK3_PLAYER2.Enabled = False
        ATTACK4_PLAYER2.Enabled = False

        'DECLARA UMA VARIÁVEL COMO STRING QUE RECEBE O NOME DO ATAQUE QUE ESTÁ ESCRITO NO BOTÃO.'
        'A FUNÇÃO RECEBE A STRING E O DANO PARA EXECUTAR AS LINHAS DE COMANDO.'

        'SOB O EFEITO DE DRENAGEM.'

        If BUTTON_STATUS_PLAYER2.Text = "DRENADO" Then

            Dim attackName As String = "Leech Life"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Inseto", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        'SOB O EFEITO DE ENVENENAMENTO.'

        If BUTTON_STATUS_PLAYER2.Text = "ENVENENADO" Then

            Dim attackName As String = "Poison Powder"
            Dim damage As Integer = 10

            MessageBox.Show("Dano do ataque " & attackName & ": " & damage + 10.ToString())

            For Each item As ListViewItem In LISTVIEW2_PLAYER2.Items

                Dim hpValue As Integer

                If Integer.TryParse(item.Text, hpValue) Then

                    Dim pokemonType As String = BUTTON_TYPE_PLAYER2.Text
                    Dim resultadoDano = CalcularDano("Veneno", pokemonType, damage)
                    Dim calculatedDamage As Integer = resultadoDano.damage
                    Dim superEfetivo As Boolean = resultadoDano.superEfetivo

                    If superEfetivo Then

                        MessageBox.Show("SUPER EFETIVO!")

                    End If

                    'AQUI ESTÁ A ALTERAÇÃO.'

                    hpValue -= calculatedDamage

                    Dim aumentoHP As Integer = CInt(1 * damage)

                    hpValue -= aumentoHP

                    item.Text = hpValue.ToString()

                    If hpValue <= 0 Then

                        LISTVIEW2_PLAYER2.Items.Remove(item)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView2 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon2 As String = selectedDataRowView2("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon2)
                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1
                            LoadComboBoxData()

                        End If

                    End If

                    Exit For

                End If

            Next

        End If

        Dim buttonName As String = ATTACK4_PLAYER2.Text

        Select Case buttonName

            Case "Vine Whip"

                AplicarAtaqueNoPokemon1("Vine Whip", 45, "Grama")

            Case "Leer"

                'A TÉCNICA INSERE O STATUS PROVOCADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "PROVOCADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("A provocação faz com que o Pokémon do Player1 deixe sua guarda exposta.")
                                MessageBox.Show("A defesa cai.")

                                BUTTON_STATUS_PLAYER1.Text = "PROVOCADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Withdraw"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER2.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Thunder Wave"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Defense Curl"

                'A TÉCNICA AUMENTA OS STATUS DE DEFESA DO POKÉMON.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME2 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim novoStatus As String = "BLINDADO"

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()

                            If rowsAffected > 0 Then

                                MessageBox.Show("O Pokémon aumenta sua própria defesa.")

                                BUTTON_STATUS_PLAYER2.Text = "BLINDADO"

                                LoadComboBoxData()
                                LISTVIEW1_PLAYER1.Refresh()
                                LISTVIEW2_PLAYER2.Refresh()

                            Else

                                MessageBox.Show("Nenhum Pokémon foi afetado no banco de dados.")

                            End If

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Confuse Ray"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player1 está confuso."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Rock Throw"

                AplicarAtaqueNoPokemon1("Rock Throw", 45, "Pedra")

            Case "Seismic Toss "

                AplicarAtaqueNoPokemon1("Seismic Toss", 70, "Lutador")

            Case "Foresight"

            Case "Struggle"

                AplicarAtaqueNoPokemon1("Struggle", 50, "Normal")

            Case "Quick Attack"

                AplicarAtaqueNoPokemon1("Quick Attack", 40, "Normal")

            Case "Psybeam"

                AplicarAtaqueNoPokemon1("Psybeam", 40, "Psíquico")

            Case "Sing"

                ' A TÉCNICA INSERE O STATUS SONO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "SONO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "SONO" Then

                                    mensagem = "O Pokémon do Player2 dorme."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Stun Spore"

                'A TÉCNICA INSERE O STATUS DE PARALISIA NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "PARALISADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Grama" Then
                                If novoStatus = "PARALISADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "PARALISADO"
                                    mensagem = "O Pokémon do Player2 foi paralisado."
                                ElseIf BUTTON_TYPE_PLAYER1.Text = "Grama" Then
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                    mensagem = "Imune a esta técnica."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Poison Powder"

                'A TÉCNICA INSERE O STATUS DE ENVENENADO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.8, "ENVENENADO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If BUTTON_TYPE_PLAYER1.Text = "Veneno" Then
                                BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                mensagem = "Imune a esta técnica."
                            End If


                            If rowsAffected > 0 And BUTTON_TYPE_PLAYER1.Text <> "Veneno" Then
                                If novoStatus = "ENVENENADO" Then
                                    BUTTON_STATUS_PLAYER1.Text = "ENVENENADO"
                                    mensagem = "O Pokémon foi envenenado."
                                Else
                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"
                                End If
                            Else
                                mensagem = "A técnica não surtiu efeito."
                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                    For Each itemToRemove As ListViewItem In pokemonToRemovePlayer2

                        LISTVIEW2_PLAYER2.Items.Remove(itemToRemove)

                        If ComboBox2_TIMEPLAYER2.SelectedIndex <> -1 Then

                            Dim selectedDataRowView1 As DataRowView = CType(ComboBox2_TIMEPLAYER2.SelectedItem, DataRowView)
                            Dim selectedPokemon1 As String = selectedDataRowView1("NOME").ToString()

                            ExcluirPokemonDoTime2(selectedPokemon1)

                            ComboBox2_TIMEPLAYER2.Refresh()
                            ComboBox2_TIMEPLAYER2.SelectedIndex = -1

                            LoadComboBoxData()

                        End If

                    Next

                End If

            Case "Confusion"

                ' A TÉCNICA INSERE O STATUS CONFUSO NO POKEMON ADVERSÁRIO.'

                Dim selectedDataRowView As DataRowView = CType(ComboBox1_TIMEPLAYER1.SelectedItem, DataRowView)

                If selectedDataRowView IsNot Nothing Then

                    Dim nomePokemonSelecionado As String = selectedDataRowView("NOME").ToString()
                    Dim queryString As String = "UPDATE TIME1 SET PSTATUS = @novoStatus WHERE NOME = @nomePokemonSelecionado"
                    Dim random As New Random()

                    Using connection As New MySqlConnection("server=127.0.0.1;userid=root;password='';database=Pokemon_Game")

                        connection.Open()

                        Using command As New MySqlCommand(queryString, connection)

                            Dim chance As Double = random.NextDouble()
                            Dim novoStatus As String = If(chance < 0.5, "CONFUSO", "NORMAL")

                            command.Parameters.AddWithValue("@novoStatus", novoStatus)
                            command.Parameters.AddWithValue("@nomePokemonSelecionado", nomePokemonSelecionado)

                            Dim rowsAffected As Integer = command.ExecuteNonQuery()
                            Dim mensagem As String = ""

                            If rowsAffected > 0 Then

                                If novoStatus = "CONFUSO" Then

                                    mensagem = "O Pokémon do Player1 está confuso."
                                    BUTTON_STATUS_PLAYER1.Text = novoStatus

                                Else

                                    mensagem = "A técnica não surtiu efeito."
                                    BUTTON_STATUS_PLAYER1.Text = "NORMAL"

                                End If

                            Else

                                mensagem = "A técnica não surtiu efeito."

                            End If

                            MessageBox.Show(mensagem)
                            LoadComboBoxData()
                            LISTVIEW1_PLAYER1.Refresh()
                            LISTVIEW2_PLAYER2.Refresh()

                        End Using

                    End Using

                    Dim pokemonToRemovePlayer2 As New List(Of ListViewItem)

                    For Each item2 As ListViewItem In LISTVIEW2_PLAYER2.Items

                        If item2.SubItems.Count >= 2 Then

                            Dim mpValue As Integer

                            If Integer.TryParse(item2.SubItems(1).Text, mpValue) Then

                                mpValue -= 10

                                item2.SubItems(1).Text = mpValue.ToString()

                                If mpValue <= 0 Then

                                    pokemonToRemovePlayer2.Add(item2)

                                End If

                            End If

                        End If

                    Next

                End If

            Case "Pay Day"

                AplicarAtaqueNoPokemon1("Pay Day", 40, "Normal")

            Case "Karate Chop"

                AplicarAtaqueNoPokemon1("Karate Chop", 50, "Lutador")

            Case "Double Slap"

                AplicarAtaqueNoPokemon1("Double Slap", 15, "Normal")

            Case "Bounce"

                AplicarAtaqueNoPokemon1("Bounce", 85, "Normal")

            Case "Water Gun"

                AplicarAtaqueNoPokemon1("Water Gun", 40, "Água")

            Case "Fury Attack"

                AplicarAtaqueNoPokemon1("Fury Attack", 40, "Normal")

            Case "Rage"

                AplicarAtaqueNoPokemon1("Fury Attack", 20, "Rage")

            Case "Night Shade"

                AplicarAtaqueNoPokemon1("Night Shade", 30, "Fantasma")

            Case Else

        End Select

    End Sub



End Class
